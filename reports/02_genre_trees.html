<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Markus Radke">
<meta name="dcterms.date" content="2025-10-31">

<title>Genre Trees - Genre Discourse Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="02_genre_trees_files/libs/clipboard/clipboard.min.js"></script>
<script src="02_genre_trees_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="02_genre_trees_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="02_genre_trees_files/libs/quarto-html/popper.min.js"></script>
<script src="02_genre_trees_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="02_genre_trees_files/libs/quarto-html/anchor.min.js"></script>
<link href="02_genre_trees_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="02_genre_trees_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="02_genre_trees_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="02_genre_trees_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="02_genre_trees_files/libs/bootstrap/bootstrap-813c323200a87c37e262811031999de4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="02_genre_trees_files/libs/quarto-diagram/mermaid.min.js"></script>
<script src="02_genre_trees_files/libs/quarto-diagram/mermaid-init.js"></script>
<link href="02_genre_trees_files/libs/quarto-diagram/mermaid.css" rel="stylesheet">
<script src="02_genre_trees_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="02_genre_trees_files/libs/r2d3-render-0.1.0/r2d3-render.js"></script>

<script src="02_genre_trees_files/libs/webcomponents-2.0.0/webcomponents.js"></script>

<script src="02_genre_trees_files/libs/r2d3-binding-0.2.6/r2d3.js"></script>

<script src="02_genre_trees_files/libs/d3v6-6.2.0/d3.min.js"></script>



<link rel="stylesheet" href="styles.css">
</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="5">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#short-explanation" id="toc-short-explanation" class="nav-link active" data-scroll-target="#short-explanation"><span class="header-section-number">1</span> Short Explanation</a>
  <ul>
  <li><a href="#the-intital-genre-network" id="toc-the-intital-genre-network" class="nav-link" data-scroll-target="#the-intital-genre-network"><span class="header-section-number">1.1</span> The intital genre network</a></li>
  <li><a href="#network-of-descendant-genres" id="toc-network-of-descendant-genres" class="nav-link" data-scroll-target="#network-of-descendant-genres"><span class="header-section-number">1.2</span> Network of descendant genres</a></li>
  <li><a href="#radically-democratic-genre-trees" id="toc-radically-democratic-genre-trees" class="nav-link" data-scroll-target="#radically-democratic-genre-trees"><span class="header-section-number">1.3</span> ‘Radically democratic’ genre trees</a></li>
  </ul></li>
  <li><a href="#genre-tree-for-musicbrainz" id="toc-genre-tree-for-musicbrainz" class="nav-link" data-scroll-target="#genre-tree-for-musicbrainz"><span class="header-section-number">2</span> Genre Tree for MusicBrainz</a></li>
  <li><a href="#genre-tree-for-spotify" id="toc-genre-tree-for-spotify" class="nav-link" data-scroll-target="#genre-tree-for-spotify"><span class="header-section-number">3</span> Genre Tree for Spotify</a></li>
  </ul>
<div class="quarto-code-links"><h2>Code Links</h2><ul><li><a href="https://github.com/markusradke/GenreDiscourseAnalysis"><i class="bi bi-link-45deg"></i>Github Repository</a></li><li><a href="https://github.com/markusradke/GenreDiscourseAnalysis/blob/main/analysis/01_build_genre_trees.R"><i class="bi bi-file-code"></i>Corresponding Analysis script</a></li><li><a href="https://github.com/markusradke/GenreDiscourseAnalysis/blob/main/R/build_genre_tree.R"><i class="bi bi-file-code"></i>Helper functions - Tree Building</a></li><li><a href="https://github.com/markusradke/GenreDiscourseAnalysis/blob/main/R/map_genres.R"><i class="bi bi-file-code"></i>Helper functions - Initial Genre Mapping</a></li><li><a href="https://github.com/markusradke/GenreDiscourseAnalysis/blob/main/R/make_network_graph.R"><i class="bi bi-file-code"></i>Helper functions - Tree Plotting</a></li></ul></div></nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Genre Trees - Genre Discourse Analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Markus Radke </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 31, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="short-explanation" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Short Explanation</h1>
<p>This report presents interactive genre trees for the MusicBrainz and the digital music streaming platform Spotify. Each tree visualizes the <strong>hierarchical structure of music genres</strong> based on a dataset of popular tracks in Germany over the last 50 years (PopTraG). The trees allow users to explore sub-genres by clicking on nodes, with node size representing the number of tracks associated with each genre.</p>
<section id="the-intital-genre-network" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="the-intital-genre-network"><span class="header-section-number">1.1</span> The intital genre network</h2>
<p>In the initial genre network, <strong>each node represents a genre tag</strong> on the corresponding platform. The <strong>edges of this initial network are based on the co-occurrence</strong> of genre tags across all tracks in the PopTraG dataset (i.e., the probability that a certain genre tag appears, given that another genre tag was assigned to a track; see example with “pop” and “hip hop” below). The more frequently two genres co-occur, the stronger the connection (edge) between them. Musicbrainz provides additional community votes for genre assignments (for Spotify we used multiple artists per track to generate votes), which are used to <strong>weight the edges genre network</strong>. Here, we multiplied the link strengh by the mean relative vote for a genre across all tracks where both genres appear. The more users voted for a genre, i.e.&nbsp;the more unambigously a track can be assigned to a genre, the stronger the connection becomes (see continued example).</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
rock -- P(metal|rock) * meanRelFreqVotes(metal|rock) --&gt; metal
metal -- P(rock|metal) * meanRelFreqVotes(rock|metal) --&gt; rock
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="network-of-descendant-genres" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="network-of-descendant-genres"><span class="header-section-number">1.2</span> Network of descendant genres</h2>
<p>Next, we determine which genre is a descendant of the other. Genres with descendants should be distributed more evenly across multiple genres. Thus, in our initial genre network, we eliminate the weaker connection between the two genres. To account for the uncertainty in this decision, we subtract the weaker conditional probability from the conditional probability of the stronger connection (see the continued example).</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
rock -. P(metal|rock) .-x metal
metal -- P(rock|metal) - P(rock|metal) --&gt; rock
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="radically-democratic-genre-trees" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="radically-democratic-genre-trees"><span class="header-section-number">1.3</span> ‘Radically democratic’ genre trees</h2>
<p>Now, we transform the directed network of descendant genres into a hierarchical tree. We assume that the strongest link to a potential parent genre determines the most suitable parent genre. Thus, we eliminate all other outgoing links to potential parents (see the continued example).</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
metal --&gt; rock
metal -.-x pop
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<!-- ## Genre mapping
For performing classification tasks later on, we need to transform our multilabel genre assignments into single-label assignements. Therefore, we choose the initial genre from each track's user assigned tags. We identify the most appropriate initial genre by following the path from the root of the tree to the leaf genres, always choosing the path with the highest number of votes down all sub-branches in the tracks genre list. When we reach a genre that has no heirs in the track's genre list, we assign this genre as the initial genre for this track. -->
<!-- Was ist mit einem Fall, wo zwar ein Track in einem Tiefen Genre ist, aber nicht der gesamte Path? Das könnte zum Beispiel Classical erklären in den Leafs? Die bleiben vielleicht alle bei Classic Rock stecken und kommen gar nicht zu classical -->
<!-- TODO: Make an example plot / multiple example plots -->
</section>
</section>
<section id="genre-tree-for-musicbrainz" class="level1 page-columns page-full" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Genre Tree for MusicBrainz</h1>
<div class="column-screen-inset-right">
<div class="plot-container">
<p><strong>Navigation:</strong> Click and drag to pan • Mouse wheel to zoom in/out • Click “Center Root” to reset view • Click blue nodes to expand/collapse</p>
<div class="cell">
<div class="cell-output-display">
<div id="htmlwidget-6f962535fda9317528bc" style="width:100%;height:1000px;" class="r2d3 html-widget"></div>
<script type="application/json" data-for="htmlwidget-6f962535fda9317528bc">{"x":{"data":{"tree":{"name":"POPULAR MUSIC","size":0.001,"fill":"#000000ff","children":[{"name":"rock","size":22754.41083295581,"fill":"#808080ff","children":[{"name":"acoustic rock","size":368.1568515550677,"fill":"#808080ff"},{"name":"alternative metal","size":869.5779189504609,"fill":"#808080ff"},{"name":"alternative punk","size":100.568363384346,"fill":"#808080ff"},{"name":"alternative rock","size":5957.409811532877,"fill":"#808080ff","children":[{"name":"grunge","size":336.8580833126727,"fill":"#808080ff"},{"name":"post-hardcore","size":487.1592399462788,"fill":"#808080ff"}]},{"name":"americana","size":200.4201420643128,"fill":"#808080ff"},{"name":"aor","size":172.8848687880039,"fill":"#808080ff"},{"name":"arena rock","size":242.4679268180245,"fill":"#808080ff"},{"name":"art rock","size":651.4246411283676,"fill":"#808080ff"},{"name":"avant-garde","size":110.7279960409773,"fill":"#808080ff"},{"name":"blues","size":1364.597304916368,"fill":"#808080ff","children":[{"name":"country blues","size":76.66358389225229,"fill":"#808080ff"},{"name":"electric blues","size":159.8553777432657,"fill":"#808080ff"}]},{"name":"blues rock","size":1798.095064052215,"fill":"#808080ff"},{"name":"britpop","size":432.9642581194458,"fill":"#808080ff"},{"name":"classic rock","size":1769.750290337726,"fill":"#808080ff"},{"name":"contemporary folk","size":227.6947705930057,"fill":"#808080ff"},{"name":"country","size":1455.081058557043,"fill":"#808080ff","children":[{"name":"alternative country","size":104.9791884455264,"fill":"#808080ff"},{"name":"bluegrass","size":168.7904394514127,"fill":"#808080ff"},{"name":"classic country","size":29.99287312305253,"fill":"#808080ff"},{"name":"contemporary country","size":161.3127486474588,"fill":"#808080ff"}]},{"name":"country rock","size":433.3716889864814,"fill":"#808080ff"},{"name":"emo","size":227.718021837817,"fill":"#808080ff"},{"name":"experimental","size":364.6642836257008,"fill":"#808080ff"},{"name":"experimental rock","size":202.0063537553769,"fill":"#808080ff"},{"name":"folk","size":2221.312824107813,"fill":"#808080ff","children":[{"name":"celtic","size":255.2446616346367,"fill":"#808080ff"}]},{"name":"folk rock","size":1971.114282563218,"fill":"#808080ff"},{"name":"funk rock","size":100.8343505235328,"fill":"#808080ff"},{"name":"garage rock","size":251.2050304068328,"fill":"#808080ff"},{"name":"glam","size":111.1116526390962,"fill":"#808080ff"},{"name":"glam rock","size":268.2863613721147,"fill":"#808080ff"},{"name":"gospel","size":220.302941485983,"fill":"#808080ff"},{"name":"gothic rock","size":465.2132154976595,"fill":"#808080ff"},{"name":"hard rock","size":4820.285229127846,"fill":"#808080ff"},{"name":"heavy metal","size":4936.784515272203,"fill":"#808080ff","children":[{"name":"power metal","size":1894.201604158369,"fill":"#808080ff"},{"name":"speed metal","size":394.6771538849294,"fill":"#808080ff"}]},{"name":"indie rock","size":3359.059874852542,"fill":"#808080ff","children":[{"name":"chamber pop","size":163.5349372923025,"fill":"#808080ff"},{"name":"dream pop","size":122.1441200453094,"fill":"#808080ff"},{"name":"indie folk","size":365.1422996993297,"fill":"#808080ff"}]},{"name":"industrial rock","size":197.4600451584405,"fill":"#808080ff"},{"name":"instrumental","size":402.9408248824395,"fill":"#808080ff"},{"name":"instrumental rock","size":71.46656386900467,"fill":"#808080ff"},{"name":"j-rock","size":79.42295482295482,"fill":"#808080ff"},{"name":"jazz rock","size":69.21244250773456,"fill":"#808080ff"},{"name":"mainstream rock","size":73.77851247184091,"fill":"#808080ff"},{"name":"metal","size":4133.059779758336,"fill":"#808080ff","children":[{"name":"black metal","size":874.3879406558353,"fill":"#808080ff"},{"name":"death metal","size":1715.732290082613,"fill":"#808080ff"},{"name":"doom metal","size":375.3886301892986,"fill":"#808080ff"},{"name":"folk metal","size":625.1870077634784,"fill":"#808080ff"},{"name":"gothic metal","size":705.2748391728343,"fill":"#808080ff"},{"name":"grindcore","size":223.954643967144,"fill":"#808080ff"},{"name":"groove metal","size":257.9240264551634,"fill":"#808080ff"},{"name":"industrial metal","size":489.0766987420416,"fill":"#808080ff"},{"name":"melodic death metal","size":782.8818300371265,"fill":"#808080ff"},{"name":"metalcore","size":1246.689464652819,"fill":"#808080ff"},{"name":"progressive metal","size":1197.745902421936,"fill":"#808080ff"},{"name":"symphonic metal","size":621.2798239898365,"fill":"#808080ff"},{"name":"thrash metal","size":1243.229103356916,"fill":"#808080ff"}]},{"name":"neo-psychedelia","size":136.4470756837379,"fill":"#808080ff"},{"name":"new wave","size":1398.547151668231,"fill":"#808080ff"},{"name":"nu metal","size":459.6803204043478,"fill":"#808080ff"},{"name":"piano rock","size":65.8527993498034,"fill":"#808080ff"},{"name":"pop","size":23486.84122980115,"fill":"#808080ff","children":[{"name":"2000s","size":49.99808751471309,"fill":"#808080ff"},{"name":"2020s","size":91.24745243591275,"fill":"#808080ff"},{"name":"alternative pop","size":200.1607721846808,"fill":"#808080ff"},{"name":"alternative r&b","size":168.9531397763237,"fill":"#808080ff"},{"name":"art pop","size":273.426299241731,"fill":"#808080ff"},{"name":"ballad","size":1044.212450390434,"fill":"#808080ff"},{"name":"baroque pop","size":109.373518897943,"fill":"#808080ff"},{"name":"blue-eyed soul","size":232.2688384032031,"fill":"#808080ff"},{"name":"bubblegum pop","size":38.14638094959951,"fill":"#808080ff"},{"name":"chanson française","size":292.241627202347,"fill":"#808080ff"},{"name":"christmas music","size":260.5680573537604,"fill":"#808080ff"},{"name":"classical","size":1833.431500888218,"fill":"#808080ff","children":[{"name":"classical crossover","size":273.3906529068664,"fill":"#808080ff"},{"name":"contemporary classical","size":142.2695418745341,"fill":"#808080ff"},{"name":"opera","size":238.1777872998461,"fill":"#808080ff"},{"name":"orchestral","size":89.92118104260048,"fill":"#808080ff"},{"name":"romantic classical","size":85.42930495430495,"fill":"#808080ff"}]},{"name":"contemporary r&b","size":994.752237912954,"fill":"#808080ff"},{"name":"country pop","size":165.2157435686923,"fill":"#808080ff"},{"name":"dance-pop","size":1411.676818474549,"fill":"#808080ff"},{"name":"dance-rock","size":127.9264313642869,"fill":"#808080ff"},{"name":"disco","size":611.8026142791219,"fill":"#808080ff"},{"name":"easy listening","size":524.6607062285741,"fill":"#808080ff"},{"name":"electronic","size":6428.587533000805,"fill":"#808080ff","children":[{"name":"acid jazz","size":140.0401425115145,"fill":"#808080ff"},{"name":"alternative dance","size":165.3424941088773,"fill":"#808080ff"},{"name":"ambient","size":939.996271186962,"fill":"#808080ff"},{"name":"big beat","size":86.10965396964725,"fill":"#808080ff"},{"name":"breakbeat","size":113.866081326574,"fill":"#808080ff"},{"name":"breaks","size":49.47966049520095,"fill":"#808080ff"},{"name":"chillout","size":122.1224432342745,"fill":"#808080ff"},{"name":"club","size":171.0261486980395,"fill":"#808080ff"},{"name":"dance","size":1034.507247796486,"fill":"#808080ff"},{"name":"dark wave","size":256.8178041585701,"fill":"#808080ff"},{"name":"downtempo","size":762.3634168741364,"fill":"#808080ff"},{"name":"drum and bass","size":275.1136325394053,"fill":"#808080ff"},{"name":"dub","size":117.7914030809628,"fill":"#808080ff"},{"name":"dubstep","size":258.169417308536,"fill":"#808080ff"},{"name":"ebm","size":239.3542555612602,"fill":"#808080ff"},{"name":"edm","size":349.9510647017244,"fill":"#808080ff"},{"name":"electro","size":615.6454138587078,"fill":"#808080ff"},{"name":"electro house","size":321.7263584915907,"fill":"#808080ff"},{"name":"electronic rock","size":62.72407620255063,"fill":"#808080ff"},{"name":"electronica","size":331.589396921713,"fill":"#808080ff"},{"name":"euro house","size":288.0821452396399,"fill":"#808080ff"},{"name":"eurodance","size":387.4622249511522,"fill":"#808080ff"},{"name":"garage house","size":19.43373300812896,"fill":"#808080ff"},{"name":"glitch","size":26.98315620390111,"fill":"#808080ff"},{"name":"gothic","size":275.8994819823869,"fill":"#808080ff"},{"name":"grime","size":68.59078234137797,"fill":"#808080ff"},{"name":"hardstyle","size":251.1185286935287,"fill":"#808080ff"},{"name":"house","size":1345.977037020977,"fill":"#808080ff","children":[{"name":"deep house","size":175.0843880603276,"fill":"#808080ff"}]},{"name":"idm","size":176.5203569743237,"fill":"#808080ff"},{"name":"indietronica","size":115.932436470594,"fill":"#808080ff"},{"name":"industrial","size":507.5216288391593,"fill":"#808080ff"},{"name":"jungle","size":32.40406800629711,"fill":"#808080ff"},{"name":"leftfield","size":65.96611916966481,"fill":"#808080ff"},{"name":"modern classical","size":320.6247308060913,"fill":"#808080ff"},{"name":"new age","size":450.2027514338657,"fill":"#808080ff"},{"name":"progressive house","size":235.8960594026011,"fill":"#808080ff"},{"name":"progressive trance","size":88.82513951640513,"fill":"#808080ff"},{"name":"tech house","size":135.7238592481735,"fill":"#808080ff"},{"name":"techno","size":729.0594692054627,"fill":"#808080ff"},{"name":"trance","size":857.3445310037359,"fill":"#808080ff","children":[{"name":"vocal trance","size":80.24821408094157,"fill":"#808080ff"}]},{"name":"trip hop","size":360.3859372634601,"fill":"#808080ff"},{"name":"uk garage","size":72.62676586100667,"fill":"#808080ff"}]},{"name":"electropop","size":727.296602325549,"fill":"#808080ff"},{"name":"europop","size":702.6575255399431,"fill":"#808080ff"},{"name":"folk pop","size":241.5995095952317,"fill":"#808080ff"},{"name":"funk","size":499.4781742860859,"fill":"#808080ff"},{"name":"hip hop","size":21255.30853519097,"fill":"#808080ff","children":[{"name":"alternative hip hop","size":117.3349274380431,"fill":"#808080ff"},{"name":"boom bap","size":91.26746211218091,"fill":"#808080ff"},{"name":"chillwave","size":70.2463825063825,"fill":"#808080ff"},{"name":"conscious hip hop","size":218.4607260560927,"fill":"#808080ff"},{"name":"east coast hip hop","size":392.3404772393251,"fill":"#808080ff"},{"name":"gangsta rap","size":820.9221133635159,"fill":"#808080ff"},{"name":"hardcore hip hop","size":115.4858053968631,"fill":"#808080ff"},{"name":"instrumental hip hop","size":74.53736386735613,"fill":"#808080ff"},{"name":"lo-fi","size":115.3902496897617,"fill":"#808080ff"},{"name":"lo-fi hip hop","size":69.2609237984238,"fill":"#808080ff"},{"name":"pop rap","size":1258.737045604546,"fill":"#808080ff"},{"name":"southern hip hop","size":232.3734056284559,"fill":"#808080ff"},{"name":"trap","size":1196.00108427279,"fill":"#808080ff"},{"name":"underground hip hop","size":38.92164613164613,"fill":"#808080ff"},{"name":"west coast hip hop","size":177.6912523902724,"fill":"#808080ff"}]},{"name":"indie pop","size":1244.77471521653,"fill":"#808080ff"},{"name":"j-pop","size":215.7319735819736,"fill":"#808080ff"},{"name":"jazz","size":4117.011764734501,"fill":"#808080ff","children":[{"name":"bebop","size":34.63160536745676,"fill":"#808080ff"},{"name":"big band","size":65.98858596911531,"fill":"#808080ff"},{"name":"bossa nova","size":112.2293304081539,"fill":"#808080ff"},{"name":"contemporary jazz","size":220.8922468324772,"fill":"#808080ff"},{"name":"cool jazz","size":32.99177232312638,"fill":"#808080ff"},{"name":"jazz fusion","size":166.7217493670188,"fill":"#808080ff"},{"name":"jazz-funk","size":125.4663865207405,"fill":"#808080ff"},{"name":"latin jazz","size":57.10722847695465,"fill":"#808080ff"},{"name":"nu jazz","size":76.27887591323888,"fill":"#808080ff"},{"name":"post-bop","size":52.21982272970861,"fill":"#808080ff"},{"name":"smooth jazz","size":215.8727109783178,"fill":"#808080ff"},{"name":"soul jazz","size":72.7591035129568,"fill":"#808080ff"},{"name":"swing","size":177.4223936896768,"fill":"#808080ff"},{"name":"vocal jazz","size":359.925425189956,"fill":"#808080ff"}]},{"name":"k-pop","size":398.8205697528278,"fill":"#808080ff"},{"name":"latin","size":917.3713522412905,"fill":"#808080ff","children":[{"name":"reggaeton","size":306.1046702154055,"fill":"#808080ff"},{"name":"salsa","size":116.8637660999655,"fill":"#808080ff"}]},{"name":"latin pop","size":332.8403047475286,"fill":"#808080ff"},{"name":"musical","size":242.2168788088486,"fill":"#808080ff"},{"name":"pop soul","size":376.1769274327506,"fill":"#808080ff"},{"name":"r&b","size":1833.135911895997,"fill":"#808080ff","children":[{"name":"new jack swing","size":55.72575524721408,"fill":"#808080ff"}]},{"name":"reggae","size":1056.068486953427,"fill":"#808080ff","children":[{"name":"dancehall","size":357.9003954385511,"fill":"#808080ff"},{"name":"reggae-pop","size":76.49706895366138,"fill":"#808080ff"},{"name":"roots reggae","size":97.90275906123262,"fill":"#808080ff"}]},{"name":"schlager","size":7416.749722910626,"fill":"#808080ff"},{"name":"sophisti-pop","size":143.1790617498928,"fill":"#808080ff"},{"name":"soul","size":2484.217028140513,"fill":"#808080ff","children":[{"name":"motown","size":49.33247079404369,"fill":"#808080ff"},{"name":"neo soul","size":309.9179163696641,"fill":"#808080ff"},{"name":"quiet storm","size":47.12504130079948,"fill":"#808080ff"},{"name":"smooth soul","size":67.83333337320106,"fill":"#808080ff"}]},{"name":"synth-pop","size":1940.049645029703,"fill":"#808080ff"},{"name":"teen pop","size":371.9098396425612,"fill":"#808080ff"},{"name":"traditional pop","size":145.9357272550889,"fill":"#808080ff"},{"name":"west coast swing","size":10.41098330037564,"fill":"#808080ff"}]},{"name":"pop punk","size":453.6496511996723,"fill":"#808080ff"},{"name":"pop rock","size":5112.093715729796,"fill":"#808080ff"},{"name":"post-grunge","size":295.4223487719375,"fill":"#808080ff"},{"name":"post-punk","size":448.5367799219065,"fill":"#808080ff"},{"name":"post-rock","size":262.9722693524238,"fill":"#808080ff"},{"name":"power pop","size":194.9525438899712,"fill":"#808080ff"},{"name":"progressive rock","size":2465.57068023608,"fill":"#808080ff"},{"name":"psychedelic","size":67.37391064157896,"fill":"#808080ff"},{"name":"psychedelic pop","size":101.8386549985598,"fill":"#808080ff"},{"name":"psychedelic rock","size":587.8200162310443,"fill":"#808080ff"},{"name":"punk","size":2934.712831167839,"fill":"#808080ff","children":[{"name":"hardcore punk","size":434.392910700834,"fill":"#808080ff"},{"name":"ska punk","size":106.6031790139485,"fill":"#808080ff"}]},{"name":"punk rock","size":1273.385168489394,"fill":"#808080ff"},{"name":"rock and roll","size":510.0696947442261,"fill":"#808080ff"},{"name":"rockabilly","size":277.3411928065923,"fill":"#808080ff"},{"name":"shoegaze","size":85.61977953258072,"fill":"#808080ff"},{"name":"singer-songwriter","size":1856.165977223333,"fill":"#808080ff","children":[{"name":"mpb","size":119.948088023088,"fill":"#808080ff"}]},{"name":"ska","size":315.3327331981744,"fill":"#808080ff"},{"name":"soft rock","size":1410.297782734634,"fill":"#808080ff"},{"name":"southern rock","size":283.5724808032303,"fill":"#808080ff"},{"name":"stoner rock","size":190.7970407915771,"fill":"#808080ff"},{"name":"symphonic rock","size":225.898504891001,"fill":"#808080ff"}]}]},"weights":{"key":["2000s->pop","2020s->pop","acid jazz->electronic","acoustic rock->rock","alternative country->country","alternative dance->electronic","alternative hip hop->hip hop","alternative metal->rock","alternative pop->pop","alternative punk->rock","alternative r&b->pop","alternative rock->rock","ambient->electronic","americana->rock","aor->rock","arena rock->rock","art pop->pop","art rock->rock","avant-garde->rock","ballad->pop","baroque pop->pop","bebop->jazz","big band->jazz","big beat->electronic","black metal->metal","blue-eyed soul->pop","bluegrass->country","blues->rock","blues rock->rock","boom bap->hip hop","bossa nova->jazz","breakbeat->electronic","breaks->electronic","britpop->rock","bubblegum pop->pop","celtic->folk","chamber pop->indie rock","chanson française->pop","chillout->electronic","chillwave->hip hop","christmas music->pop","classic country->country","classic rock->rock","classical->pop","classical crossover->classical","club->electronic","conscious hip hop->hip hop","contemporary classical->classical","contemporary country->country","contemporary folk->rock","contemporary jazz->jazz","contemporary r&b->pop","cool jazz->jazz","country->rock","country blues->blues","country pop->pop","country rock->rock","dance->electronic","dance-pop->pop","dance-rock->pop","dancehall->reggae","dark wave->electronic","death metal->metal","deep house->house","disco->pop","doom metal->metal","downtempo->electronic","dream pop->indie rock","drum and bass->electronic","dub->electronic","dubstep->electronic","east coast hip hop->hip hop","easy listening->pop","ebm->electronic","edm->electronic","electric blues->blues","electro->electronic","electro house->electronic","electronic->pop","electronic rock->electronic","electronica->electronic","electropop->pop","emo->rock","euro house->electronic","eurodance->electronic","europop->pop","experimental->rock","experimental rock->rock","folk->rock","folk metal->metal","folk pop->pop","folk rock->rock","funk->pop","funk rock->rock","gangsta rap->hip hop","garage house->electronic","garage rock->rock","glam->rock","glam rock->rock","glitch->electronic","gospel->rock","gothic->electronic","gothic metal->metal","gothic rock->rock","grime->electronic","grindcore->metal","groove metal->metal","grunge->alternative rock","hard rock->rock","hardcore hip hop->hip hop","hardcore punk->punk","hardstyle->electronic","heavy metal->rock","hip hop->pop","house->electronic","idm->electronic","indie folk->indie rock","indie pop->pop","indie rock->rock","indietronica->electronic","industrial->electronic","industrial metal->metal","industrial rock->rock","instrumental->rock","instrumental hip hop->hip hop","instrumental rock->rock","j-pop->pop","j-rock->rock","jazz->pop","jazz fusion->jazz","jazz rock->rock","jazz-funk->jazz","jungle->electronic","k-pop->pop","latin->pop","latin jazz->jazz","latin pop->pop","leftfield->electronic","lo-fi->hip hop","lo-fi hip hop->hip hop","mainstream rock->rock","melodic death metal->metal","metal->rock","metalcore->metal","modern classical->electronic","motown->soul","mpb->singer-songwriter","musical->pop","neo soul->soul","neo-psychedelia->rock","new age->electronic","new jack swing->r&b","new wave->rock","nu jazz->jazz","nu metal->rock","opera->classical","orchestral->classical","piano rock->rock","pop->rock","pop punk->rock","pop rap->hip hop","pop rock->rock","pop soul->pop","post-bop->jazz","post-grunge->rock","post-hardcore->alternative rock","post-punk->rock","post-rock->rock","power metal->heavy metal","power pop->rock","progressive house->electronic","progressive metal->metal","progressive rock->rock","progressive trance->electronic","psychedelic->rock","psychedelic pop->rock","psychedelic rock->rock","punk->rock","punk rock->rock","quiet storm->soul","r&b->pop","reggae->pop","reggae-pop->reggae","reggaeton->latin","rock and roll->rock","rockabilly->rock","romantic classical->classical","roots reggae->reggae","salsa->latin","schlager->pop","shoegaze->rock","singer-songwriter->rock","ska->rock","ska punk->punk","smooth jazz->jazz","smooth soul->soul","soft rock->rock","sophisti-pop->pop","soul->pop","soul jazz->jazz","southern hip hop->hip hop","southern rock->rock","speed metal->heavy metal","stoner rock->rock","swing->jazz","symphonic metal->metal","symphonic rock->rock","synth-pop->pop","tech house->electronic","techno->electronic","teen pop->pop","thrash metal->metal","traditional pop->pop","trance->electronic","trap->hip hop","trip hop->electronic","uk garage->electronic","underground hip hop->hip hop","vocal jazz->jazz","vocal trance->trance","west coast hip hop->hip hop","west coast swing->pop","rock->POPULAR MUSIC"],"weight":[0.6518161800868442,0.5046843634700068,0.5444423240668471,0.8577277427087892,0.7445742042166185,0.6477873335429438,0.9462868145788901,0.6502928170007631,0.7011630454036047,0.8313060541739998,0.4040717800244993,0.5556484541072864,0.647305030314594,0.6278965736862994,0.9286913303734242,0.8751817561555455,0.4810374505213671,0.7008133980913223,0.7458895321700388,0.8683867804313318,0.7027647029234475,0.9812919896640827,0.8815050285353112,0.8616141347414721,0.620195200307306,0.7139734688761709,0.5398372053380089,0.6202446735444169,0.7536454953430334,0.9736834184316137,0.5677364194684176,0.897961816545118,0.8888933942195757,0.7480501540796475,0.8660436661487201,0.6707385824065505,0.391554677968085,0.9398507749388826,0.8132391528399331,0.8803382450319135,0.6610262017084603,0.947563559322034,0.8212867036716518,0.2503342476087773,0.6439535090054122,0.7903179488621084,0.937779683742141,0.7137400756524593,0.7695981802205933,0.6355573249682787,0.868625178101379,0.5702169041991801,0.9744315245478036,0.3728958436076848,0.7792698682977285,0.6201892461818945,0.7645416209046917,0.5402982752522644,0.6987500566028534,0.6589479491759812,0.4855888699014379,0.6591705595218609,0.5711489549041839,0.5704191873651397,0.7297772369100392,0.6798828781942311,0.6530609911077043,0.3804706796714554,0.7540649201897748,0.5359429382791256,0.7976028499991334,0.9334276097929844,0.5421129145858293,0.7619310326181606,0.4319749273603568,0.8000262525638937,0.7334205384669059,0.549490676034702,0.2355391975115447,0.5464792073412177,0.7546319894461234,0.5718506729816738,0.6570868801044891,0.7409559042008933,0.5219521457889265,0.8485145029265947,0.5674139019416082,0.4838215267666363,0.4681675577827863,0.5283473067539844,0.6009946633602538,0.6835209335993552,0.5315743270517204,0.8135331978850402,0.8805332780909263,0.8642768103350583,0.7597548541604222,0.8937151011994428,0.8075503485238847,0.8763593147682598,0.4727877633254206,0.4586925821887784,0.6487174330712427,0.5748215284408101,0.5569605889276897,0.6662554542360272,0.6760851793723048,0.8244158816769478,0.6105661311447128,0.9603773635001629,0.5798564828528173,0.6899600375058715,0.5195488599614297,0.0613673778388014,0.5862531041253622,0.922743643678791,0.4010175003536938,0.4548338159389617,0.5935162931143938,0.5875729076909242,0.6878098803904992,0.5394231394976829,0.512841264272375,0.3717903170902367,0.9296560909739942,0.6911228707176391,0.2662600650853306,0.2930981889817743,0.2484822610099942,0.6535054929376516,0.8212435445640376,0.6552287117580922,0.7133718137173678,0.3711012144518248,0.4678078952169356,0.9054263565891473,0.7578418231085842,0.8652960395672922,0.5254893922709658,0.9326558224583222,0.9160535041541616,0.6298514815239757,0.4931470782897256,0.4640409012076397,0.4759709603182731,0.9425037907363553,0.268358511422255,0.364348374168079,0.6372845819364468,0.4529332662191157,0.51436868631479,0.6599183526235243,0.5562525597257119,0.7182735920128988,0.689636631354612,0.7081612155589811,0.7001926211290562,0.6159265972046806,0.08816566024446482,0.4794496676221455,0.6992382020118615,0.5340852338368983,0.7636249068070036,0.9726098191214471,0.8080088601238226,0.3331240412165845,0.6444402413173221,0.5417672973424476,0.4980738483109783,0.6923542295473691,0.7900607829433028,0.5314316980842052,0.6833578522625122,0.8795245123845759,0.7516635149016917,0.7455298738102194,0.736789599327048,0.6563786288617565,0.5427888198783923,0.7271387510011261,0.5089817225981107,0.2912867392177138,0.6798353587849896,0.5366704021915079,0.8577663385814693,0.8103918251958272,0.9022588945080294,0.8181752531161084,0.682159605506358,0.2875451829711562,0.6156120102841739,0.5862580820110836,0.4828360285049448,0.6409104567307692,0.8179958751155678,0.6584518422753717,0.7506811964811647,0.6881961271140997,0.4803813382902066,0.8869926041009208,0.9618247390449777,0.9008521134492289,0.6909498202069243,0.7499562400612918,0.7161066800996279,0.5918448039165867,0.8694613181236132,0.5439906025750842,0.7593976545845568,0.6903787486810279,0.9248454284591562,0.6484741835439576,0.6042109503844925,0.7191372693020269,0.8054223852910306,0.7670959992840355,0.7308971689023193,0.9886813584900884,0.8008077549252438,0.7964109502522011,0.9648485148465773,0.99809396422003,0]},"margin_left":150,"margin_right":350,"margin_top":0,"margin_bottom":0,"min_font_size":22,"max_font_size":36},"type":"list","container":"svg","options":{"container":"div","viewer":null},"script":"var d3Script = function(d3, r2d3, data, svg, width, height, options, theme, console) {\nthis.d3 = d3;\n\nsvg = d3.select(svg.node());\n/* R2D3 Source File:  N:/Materialien/Promotion/GenreDiscourseAnalysis/inst/d3/interactive_network_plot.js */\n// Interactive Network Plot - Fully responsive dimensions\nconst minNodeSpacing = 30; // Minimum spacing between nodes to prevent overlap\n\n// Get responsive width from container with timing-safe approach\nconst getResponsiveWidth = () => {\n    // Try multiple ways to get the container width\n    const svgNode = svg.node();\n    const computedStyle = window.getComputedStyle(svgNode);\n    if (computedStyle.width && computedStyle.width !== \"auto\") {\n        const width = parseFloat(computedStyle.width);\n        if (width > 0) {\n            return width - 4;\n        }\n    }\n\n    // Fallback to viewport width\n    console.log(\"Using viewport fallback width\");\n    return window.innerWidth * 0.8;\n};\n\n// Use responsive dimensions - prioritize container dimensions over r2d3 data\nconst actualHeight = (data.height || 1000) - 4; // Reduce by 4px for borders/padding\nconst actualWidth = getResponsiveWidth();\n\n// Calculate dynamic height based on tree structure\nfunction calculateRequiredHeight(root) {\n    const visibleNodes = root.descendants();\n    const nodesByDepth = {};\n\n    // Group nodes by depth level\n    visibleNodes.forEach(node => {\n        const depth = node.depth;\n        if (!nodesByDepth[depth]) {\n            nodesByDepth[depth] = [];\n        }\n        nodesByDepth[depth].push(node);\n    });\n\n    // Find the depth level with the most nodes\n    const maxNodesAtLevel = Math.max(...Object.values(nodesByDepth).map(nodes => nodes.length));\n\n    // Calculate required height: nodes * spacing (no margins needed with pan/zoom)\n    const requiredHeight = Math.max(\n        600, // Minimum height\n        maxNodesAtLevel * minNodeSpacing\n    );\n\n    return requiredHeight;\n}\n\n// Initialize with container height, will be recalculated for tree layout\nlet currentHeight = actualHeight;\n\n// Set up the SVG to exactly match the container (no manual sizing)\nsvg.attr(\"width\", actualWidth)\n    .attr(\"height\", actualHeight)\n    .style(\"background-color\", \"#fafafa\")\n    .style(\"overflow\", \"hidden\") // Remove scrollbars\n    .style(\"cursor\", \"grab\")\n    .style(\"display\", \"block\");\n\n// Add resize handler for responsive width\nwindow.addEventListener(\"resize\", function() {\n    const newWidth = getResponsiveWidth();\n    svg.attr(\"width\", newWidth);\n\n    // If there\"s tree content, we might want to recalculate layout\n    // For now, just update the SVG width - the pan/zoom will handle positioning\n});\n\n// Add zoom behavior\nconst zoom = d3.zoom()\n    .scaleExtent([0.1, 3]) // Zoom limits\n    .on(\"zoom\", (event) => {\n        container.attr(\"transform\", event.transform);\n        // Update cursor during pan\n        svg.style(\"cursor\", event.sourceEvent && event.sourceEvent.type === \"mousemove\" ? \"grabbing\" : \"grab\");\n    });\n\nsvg.call(zoom);\n\n// Create container for tree (this will be transformed by zoom/pan)\nconst container = svg.append(\"g\")\n    .attr(\"class\", \"tree-container\");\n\n// Add center button\nconst centerButton = svg.append(\"g\")\n    .attr(\"class\", \"center-button\")\n    .attr(\"transform\", \"translate(20, 20)\")\n    .style(\"cursor\", \"pointer\");\n\n// Button background\ncenterButton.append(\"rect\")\n    .attr(\"width\", 100)\n    .attr(\"height\", 30)\n    .attr(\"rx\", 5)\n    .style(\"fill\", \"#007acc\")\n    .style(\"stroke\", \"#005a9e\")\n    .style(\"stroke-width\", 1);\n\n// Button text\ncenterButton.append(\"text\")\n    .attr(\"x\", 50)\n    .attr(\"y\", 20)\n    .attr(\"text-anchor\", \"middle\")\n    .attr(\"dy\", \"0em\")\n    .style(\"fill\", \"white\")\n    .style(\"font-size\", \"12px\")\n    .style(\"font-weight\", \"bold\")\n    .style(\"pointer-events\", \"none\")\n    .text(\"Center root\");\n\n// Button click handler\ncenterButton.on(\"click\", function() {\n    centerOnRoot();\n});\n\n// Add \"Expand All\" button\nconst expandAllButton = svg.append(\"g\")\n    .attr(\"class\", \"expand-all-button\")\n    .attr(\"transform\", \"translate(20, 60)\") // Position below center button\n    .style(\"cursor\", \"pointer\");\n\n// Expand All button background\nexpandAllButton.append(\"rect\")\n    .attr(\"width\", 100)\n    .attr(\"height\", 30)\n    .attr(\"rx\", 5)\n    .style(\"fill\", \"#28a745\")\n    .style(\"stroke\", \"#1e7e34\")\n    .style(\"stroke-width\", 1);\n\n// Expand All button text\nexpandAllButton.append(\"text\")\n    .attr(\"x\", 50)\n    .attr(\"y\", 20)\n    .attr(\"text-anchor\", \"middle\")\n    .attr(\"dy\", \"0em\")\n    .style(\"fill\", \"white\")\n    .style(\"font-size\", \"12px\")\n    .style(\"font-weight\", \"bold\")\n    .style(\"pointer-events\", \"none\")\n    .text(\"Expand All\");\n\n// Expand All button click handler\nexpandAllButton.on(\"click\", function() {\n    expandAll();\n});\n\n// Add \"Fold All\" button\nconst foldAllButton = svg.append(\"g\")\n    .attr(\"class\", \"fold-all-button\")\n    .attr(\"transform\", \"translate(20, 100)\") // Position below expand button\n    .style(\"cursor\", \"pointer\");\n\n// Fold All button background\nfoldAllButton.append(\"rect\")\n    .attr(\"width\", 100)\n    .attr(\"height\", 30)\n    .attr(\"rx\", 5)\n    .style(\"fill\", \"#dc3545\")\n    .style(\"stroke\", \"#c82333\")\n    .style(\"stroke-width\", 1);\n\n// Fold All button text\nfoldAllButton.append(\"text\")\n    .attr(\"x\", 50)\n    .attr(\"y\", 20)\n    .attr(\"text-anchor\", \"middle\")\n    .attr(\"dy\", \"0em\")\n    .style(\"fill\", \"white\")\n    .style(\"font-size\", \"12px\")\n    .style(\"font-weight\", \"bold\")\n    .style(\"pointer-events\", \"none\")\n    .text(\"Fold All\");\n\n// Fold All button click handler\nfoldAllButton.on(\"click\", function() {\n    foldAll();\n});\n\n// Function to center the view on the root node\nfunction centerOnRoot() {\n    if (!hierarchyRoot) return;\n\n    // Find the actual root node position after tree layout\n    const rootNode = hierarchyRoot;\n    const rootX = rootNode.x || 0;\n    const rootY = rootNode.y || 0;\n\n    // Calculate transform to center the root in the actual viewport\n    const centerX = actualWidth / 2;\n    const centerY = actualHeight / 2; // Center in actual viewport\n\n    const transform = d3.zoomIdentity\n        .translate(centerX - rootY, centerY - rootX) // Note: x and y are swapped in horizontal tree\n        .scale(1); // Reset zoom to 1x\n\n    // Animate to center\n    svg.transition()\n        .duration(750)\n        .call(zoom.transform, transform);\n} // Copy data and create persistent hierarchy\nlet currentData = JSON.parse(JSON.stringify(data.tree));\nlet hierarchyRoot = null; // Keep the hierarchy root persistent\nlet isFirstRender = true; // Track if this is the first render\n\n// Collapse function for raw data (not used anymore but keeping for reference)\nfunction collapseToFirstLevel(node, depth = 0) {\n    if (depth >= 1 && node.children) {\n        node._children = node.children;\n        node.children = null;\n    }\n    if (node.children) {\n        node.children.forEach(child => collapseToFirstLevel(child, depth + 1));\n    }\n}\n\n// Collapse function for D3 hierarchy nodes (the one we actually use)\nfunction collapseHierarchyToFirstLevel(node, depth = 0) {\n\n    if (depth >= 1 && node.children) {\n        node._children = node.children;\n        node.children = null;\n    }\n\n    // Continue recursively for visible children\n    if (node.children) {\n        node.children.forEach(child => collapseHierarchyToFirstLevel(child, depth + 1));\n    }\n\n    // Also process hidden children to ensure deep collapse\n    if (node._children) {\n        node._children.forEach(child => collapseHierarchyToFirstLevel(child, depth + 1));\n    }\n}\n\n// Sort children by accumulated size (largest first)\nfunction sortChildrenBySize(node) {\n    // Sort visible children\n    if (node.children) {\n        node.children.sort((a, b) => calculateTotalSize(b) - calculateTotalSize(a));\n        // Recursively sort their children too\n        node.children.forEach(child => sortChildrenBySize(child));\n    }\n\n    // Sort hidden children (so they\"re in the right order when expanded)\n    if (node._children) {\n        node._children.sort((a, b) => calculateTotalSize(b) - calculateTotalSize(a));\n        // Recursively sort their children too\n        node._children.forEach(child => sortChildrenBySize(child));\n    }\n}\n\n// Find a node in the hierarchy by name\nfunction findNodeByName(root, name) {\n    if (root.data.name === name) {\n        return root;\n    }\n    if (root.children) {\n        for (let child of root.children) {\n            const found = findNodeByName(child, name);\n            if (found) return found;\n        }\n    }\n    if (root._children) {\n        for (let child of root._children) {\n            const found = findNodeByName(child, name);\n            if (found) return found;\n        }\n    }\n    return null;\n}\n\n// Check if a node has expandable children in persistent hierarchy\nfunction hasExpandableChildren(nodeName) {\n    if (!nodeName || !hierarchyRoot) {\n        console.warn(\"hasExpandableChildren: Invalid parameters\", {\n            nodeName,\n            hierarchyRoot: !!hierarchyRoot\n        });\n        return false;\n    }\n    const persistentNode = findNodeByName(hierarchyRoot, nodeName);\n    return persistentNode && (persistentNode.children || persistentNode._children);\n}\n\n// Check if a node is collapsed in persistent hierarchy\nfunction isCollapsed(nodeName) {\n    if (!nodeName || !hierarchyRoot) {\n        console.warn(\"isCollapsed: Invalid parameters\", {\n            nodeName,\n            hierarchyRoot: !!hierarchyRoot\n        });\n        return false;\n    }\n    const persistentNode = findNodeByName(hierarchyRoot, nodeName);\n    return persistentNode && persistentNode._children && !persistentNode.children;\n}\n\n// Calculate the total size of a node including all its descendants\nfunction calculateTotalSize(node) {\n    let totalSize = node.data.size || 0;\n\n    // Add sizes from visible children\n    if (node.children) {\n        for (let child of node.children) {\n            totalSize += calculateTotalSize(child);\n        }\n    }\n\n    // Add sizes from hidden children (collapsed nodes)\n    if (node._children) {\n        for (let child of node._children) {\n            totalSize += calculateTotalSize(child);\n        }\n    }\n\n    return totalSize;\n}\n\n// Get the effective size for display (aggregated size for collapsed nodes)\nfunction getEffectiveSize(displayNode, nodeName) {\n    const persistentNode = findNodeByName(hierarchyRoot, nodeName);\n\n    if (persistentNode && isCollapsed(nodeName)) {\n        // For collapsed nodes, return the total aggregated size\n        return calculateTotalSize(persistentNode);\n    } else {\n        // For expanded nodes or leaf nodes, return their own size\n        return displayNode.data.size || 0;\n    }\n}\n\n// Toggle function\nfunction toggle(d) {\n    // Safety check for data structure\n    if (!d.data) {\n        console.error(\"Node data is undefined, skipping toggle\");\n        return;\n    }\n    // Find the corresponding node in our persistent hierarchy\n    const persistentNode = findNodeByName(hierarchyRoot, d.data.name);\n    if (!persistentNode) {\n        console.error(\"Could not find node in persistent hierarchy:\", d.data.name);\n        return;\n    }\n\n    if (persistentNode.children) {\n        persistentNode._children = persistentNode.children;\n        persistentNode.children = null;\n    } else if (persistentNode._children) {\n        persistentNode.children = persistentNode._children;\n        persistentNode._children = null;\n    }\n\n    // Re-sort the entire hierarchy to maintain size-based ordering\n    sortChildrenBySize(hierarchyRoot);\n\n    update();\n}\n\n// Expand All function\nfunction expandAll() {\n    if (!hierarchyRoot) return;\n\n    // Recursively expand all nodes\n    function expandAllNodes(node) {\n        if (node._children) {\n            node.children = node._children;\n            node._children = null;\n        }\n        if (node.children) {\n            node.children.forEach(child => expandAllNodes(child));\n        }\n    }\n\n    expandAllNodes(hierarchyRoot);\n    sortChildrenBySize(hierarchyRoot);\n    update();\n\n    // Center on root and zoom out 30%\n    setTimeout(() => {\n        if (!hierarchyRoot) return;\n\n        const rootNode = hierarchyRoot;\n        const rootX = rootNode.x || 0;\n        const rootY = rootNode.y || 0;\n\n        const centerX = actualWidth / 2;\n        const centerY = actualHeight / 2;\n\n        const transform = d3.zoomIdentity\n            .translate(centerX - rootY, centerY - rootX)\n            .scale(0.7); // Zoom out 30% (100% - 30% = 70%)\n\n        svg.transition()\n            .duration(750)\n            .call(zoom.transform, transform);\n    }, 100); // Small delay to let the tree update first\n}\n\n// Fold All function\nfunction foldAll() {\n    if (!hierarchyRoot) return;\n\n    // Collapse everything to root only (no children visible)\n    function collapseToRoot(node) {\n        if (node.children) {\n            node._children = node.children;\n            node.children = null;\n        }\n        if (node._children) {\n            node._children.forEach(child => collapseToRoot(child));\n        }\n    }\n\n    collapseToRoot(hierarchyRoot);\n    sortChildrenBySize(hierarchyRoot);\n    update();\n\n    // Center on root with normal zoom (same as center button)\n    setTimeout(() => {\n        centerOnRoot();\n    }, 100); // Small delay to let the tree update first\n}\n\n// Update function\nfunction update() {\n    // Clear previous content (but keep the center button)\n    container.selectAll(\"*\").remove();\n\n    // Create or use existing hierarchy\n    if (isFirstRender) {\n        hierarchyRoot = d3.hierarchy(currentData);\n        collapseHierarchyToFirstLevel(hierarchyRoot, 0);\n        // Sort all nodes by accumulated size after initial setup\n        sortChildrenBySize(hierarchyRoot);\n        isFirstRender = false;\n    }\n\n    const root = hierarchyRoot;\n\n    // Calculate required height dynamically for tree layout\n    currentHeight = calculateRequiredHeight(root);\n\n    // Set up tree layout with full available space (no margins)\n    const treeLayout = d3.tree().size([currentHeight, actualWidth]);\n    treeLayout(root);\n\n    // Position the tree centered in the actual viewport\n    const startX = 0; // No left margin needed\n    const startY = actualHeight / 2; // Center in actual viewport\n\n    // Adjust all node positions\n    root.descendants().forEach(d => {\n        d.x = d.x - currentHeight / 2 + startY; // Center in actual viewport\n        d.y = d.y + startX; // Start from left edge\n    });\n\n    // Scale for node sizes - now considering aggregated sizes for collapsed nodes\n    const allEffectiveSizes = root.descendants().map(d => getEffectiveSize(d, d.data.name));\n    const sizeScale = d3.scaleLinear()\n        .domain([0, d3.max(allEffectiveSizes) || 1])\n        .range([4, 15]);\n\n    // Convert weights data frame to lookup object\n    const weightsLookup = {};\n    if (data.weights && Array.isArray(data.weights.key)) {\n        // R data frame comes as arrays of columns\n        for (let i = 0; i < data.weights.key.length; i++) {\n            weightsLookup[data.weights.key[i]] = data.weights.weight[i];\n        }\n    }\n\n    // Function to get edge weight from lookup\n    function getEdgeWeight(link) {\n        if (Object.keys(weightsLookup).length === 0) {\n            return null;\n        }\n        // In your graph: edges go child->parent\n        // In D3 tree: link.target = child, link.source = parent\n        // So: target->source = child->parent\n        const key = link.target.data.name + \"->\" + link.source.data.name;\n        return weightsLookup[key] || null;\n    }\n    \n    // Create scales for edge styling based on weights\n    const allWeights = root.links()\n        .map(link => getEdgeWeight(link))\n        .filter(w => w !== null);\n    \n    let strokeWidthScale, strokeColorScale;\n    if (allWeights.length > 0) {\n        const minWeight = d3.min(allWeights);\n        const maxWeight = d3.max(allWeights);\n        \n        // Stroke width: thin (0.5) for small weights, thick (4) for large weights\n        strokeWidthScale = d3.scaleLinear()\n            .domain([minWeight, maxWeight])\n            .range([0.5, 4]);\n        \n        // Stroke color: light gray for small weights, black for large weights\n        strokeColorScale = d3.scaleLinear()\n            .domain([minWeight, maxWeight])\n            .range([\"#e0e0e0\", \"#000000\"]);\n    }\n\n    // Create links\n    const links = container.selectAll(\".link\")\n        .data(root.links())\n        .enter()\n        .append(\"path\")\n        .attr(\"class\", \"link\")\n        .attr(\"d\", d3.linkHorizontal()\n            .x(d => d.y)\n            .y(d => d.x))\n        .style(\"fill\", \"none\")\n        .style(\"stroke\", d => {\n            const weight = getEdgeWeight(d);\n            return (weight !== null && strokeColorScale) ? strokeColorScale(weight) : \"#ccc\";\n        })\n        .style(\"stroke-width\", d => {\n            const weight = getEdgeWeight(d);\n            return (weight !== null && strokeWidthScale) ? strokeWidthScale(weight) : 2;\n        });\n\n    // Add tooltips to links\n    links.append(\"title\")\n        .text(d => {\n            const weight = getEdgeWeight(d);\n            if (weight !== null) {\n                return `${d.target.data.name} → ${d.source.data.name}\\nWeight: ${weight.toFixed(4)}`;\n            }\n            return `${d.target.data.name} → ${d.source.data.name}`;\n        });\n\n    // Create node groups\n    const nodes = container.selectAll(\".node\")\n        .data(root.descendants())\n        .enter()\n        .append(\"g\")\n        .attr(\"class\", \"node\")\n        .attr(\"transform\", d => `translate(${d.y}, ${d.x})`)\n        .style(\"cursor\", d => (d.data && hasExpandableChildren(d.data.name)) ? \"pointer\" : \"default\");\n\n    // Add circles\n    nodes.append(\"circle\")\n        .attr(\"r\", d => sizeScale(getEffectiveSize(d, d.data.name)))\n        .style(\"fill\", d => d.data.fill || \"#69b3a2\")\n        .style(\"stroke\", d => (d.data && hasExpandableChildren(d.data.name)) ? \"#000\" : \"none\")\n        .style(\"stroke-width\", d => (d.data && hasExpandableChildren(d.data.name)) ? 2 : 1)\n        .on(\"click\", function(event, d) {\n            // Prevent zoom behavior when clicking on nodes\n            event.stopPropagation();\n\n            // Check persistent hierarchy instead of display node\n            const persistentNode = findNodeByName(hierarchyRoot, d.data.name);\n            if (persistentNode) {\n                if (persistentNode._children || persistentNode.children) {\n                    toggle(d);\n                }\n            }\n        })\n        .on(\"mouseover\", function(event, d) {\n            if (d.data && hasExpandableChildren(d.data.name)) {\n                d3.select(this).style(\"stroke-width\", 4);\n            }\n        })\n        .on(\"mouseout\", function(event, d) {\n            d3.select(this).style(\"stroke-width\", (d.data && hasExpandableChildren(d.data.name)) ? 2 : 1);\n        });\n\n    // Add +/- indicators\n    nodes.filter(d => d.data && hasExpandableChildren(d.data.name))\n        .append(\"text\")\n        .attr(\"text-anchor\", \"middle\")\n        .attr(\"dy\", 4)\n        .style(\"font-size\", \"10px\")\n        .style(\"font-weight\", \"bold\")\n        .style(\"fill\", \"white\")\n        .style(\"pointer-events\", \"none\")\n        .text(d => isCollapsed(d.data.name) ? \"+\" : \"−\");\n\n    // Add labels\n    nodes.append(\"text\")\n        .attr(\"dy\", 3)\n        .attr(\"x\", d => hasExpandableChildren(d.data.name) ? -18 : 18)\n        .style(\"text-anchor\", d => hasExpandableChildren(d.data.name) ? \"end\" : \"start\")\n        .style(\"font-size\", \"12pt\")\n        .style(\"font-weight\", d => hasExpandableChildren(d.data.name) ? \"bold\" : \"normal\")\n        .style(\"text-decoration\", d => hasExpandableChildren(d.data.name) ? \"underline\" : \"none\")\n        .style(\"fill\", d => {\n            if (hasExpandableChildren(d.data.name)) return \"#0066cc\"; // Expandable nodes = blue\n            return \"#333\"; // Leaf nodes = dark gray\n        })\n        .style(\"cursor\", d => hasExpandableChildren(d.data.name) ? \"pointer\" : \"default\")\n        .text(d => d.data.name)\n        .on(\"click\", function(event, d) {\n            // Prevent zoom behavior when clicking on text\n            event.stopPropagation();\n\n            // Check persistent hierarchy instead of display node\n            const persistentNode = findNodeByName(hierarchyRoot, d.data.name);\n            if (persistentNode) {\n                if (persistentNode._children || persistentNode.children) {\n                    toggle(d);\n                }\n            }\n        })\n        .on(\"mouseover\", function(event, d) {\n            if (hasExpandableChildren(d.data.name)) {\n                d3.select(this).style(\"fill\", \"#0044aa\");\n            }\n        })\n        .on(\"mouseout\", function(event, d) {\n            d3.select(this).style(\"fill\", hasExpandableChildren(d.data.name) ? \"#0066cc\" : \"#333\");\n        });\n\n    // Add tooltips\n    nodes.append(\"title\")\n        .text(d => {\n            const effectiveSize = getEffectiveSize(d, d.data.name);\n            const originalSize = d.data.size || 0;\n\n            if (hasExpandableChildren(d.data.name)) {\n                const action = isCollapsed(d.data.name) ? \"expand\" : \"collapse\";\n                if (isCollapsed(d.data.name) && effectiveSize > originalSize) {\n                    return `${d.data.name} (Click to ${action}) - Aggregated size: ${effectiveSize} (own: ${originalSize})`;\n                } else {\n                    return `${d.data.name} (Click to ${action}) - Size: ${effectiveSize}`;\n                }\n            }\n            return `${d.data.name} - Size: ${effectiveSize}`;\n        });\n}\n\n// Initial render\nupdate();\n\n// Center on root after initial render\nsetTimeout(() => {\n    centerOnRoot();\n}, 100); // Small delay to ensure rendering is complete\n};","style":null,"version":6,"theme":{"default":{"background":"#FFFFFF","foreground":"#000000"},"runtime":null},"useShadow":true},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</section>
<section id="genre-tree-for-spotify" class="level1 page-columns page-full" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Genre Tree for Spotify</h1>
<p>Please click on the nodes to explore sub-genres. The font size is fixed to ensure readability. Node size represents the number of songs in each genre.</p>
<div class="column-screen-inset-right">
<div class="plot-container">
<p><strong>Navigation:</strong> Click and drag to pan • Mouse wheel to zoom in/out • Click “Center Root” to reset view • Click blue nodes to expand/collapse</p>
<div class="cell">
<div class="cell-output-display">
<div id="htmlwidget-10fcbd09fb8210320dfd" style="width:100%;height:1000px;" class="r2d3 html-widget"></div>
<script type="application/json" data-for="htmlwidget-10fcbd09fb8210320dfd">{"x":{"data":{"tree":{"name":"POPULAR MUSIC","size":0.001,"fill":"#000000ff","children":[{"name":"background jazz","size":234,"fill":"#808080ff"},{"name":"cantopop","size":132.4285714285714,"fill":"#808080ff","children":[{"name":"classic cantopop","size":58.40476190476191,"fill":"#808080ff"},{"name":"mandopop","size":129.5,"fill":"#808080ff"}]},{"name":"classic persian pop","size":242,"fill":"#808080ff"},{"name":"german hip hop","size":10275.10800449551,"fill":"#808080ff","children":[{"name":"albanian hip hop","size":265.1936507936508,"fill":"#808080ff"},{"name":"albanian pop","size":66.46468253968254,"fill":"#808080ff"},{"name":"cologne hip hop","size":286.6376373626373,"fill":"#808080ff"},{"name":"deep german hip hop","size":971.0530122655123,"fill":"#808080ff"},{"name":"frauenrap","size":345.0642857142857,"fill":"#808080ff"},{"name":"french hip hop","size":117.5706349206349,"fill":"#808080ff"},{"name":"german alternative rap","size":1362.372111222111,"fill":"#808080ff"},{"name":"german cloud rap","size":820.1968975468975,"fill":"#808080ff"},{"name":"german drill","size":777.6902528027528,"fill":"#808080ff"},{"name":"german pop","size":8317.754513542013,"fill":"#808080ff","children":[{"name":"classic schlager","size":5301.258669108669,"fill":"#808080ff","children":[{"name":"austropop","size":1385.992857142857,"fill":"#808080ff"},{"name":"easy listening","size":656.3599567099567,"fill":"#808080ff"},{"name":"volksmusik","size":1950.642857142857,"fill":"#808080ff"}]},{"name":"german indie","size":2312.919047619047,"fill":"#808080ff","children":[{"name":"antideutsche","size":835.9464285714286,"fill":"#808080ff"}]},{"name":"german reggae","size":581.438492063492,"fill":"#808080ff"},{"name":"german rock","size":3767.041702741702,"fill":"#808080ff","children":[{"name":"deutschrock","size":1360.083333333333,"fill":"#808080ff"},{"name":"german punk","size":1237.326190476191,"fill":"#808080ff"},{"name":"kabarett","size":1322.746825396825,"fill":"#808080ff"},{"name":"liedermacher","size":1520.969047619048,"fill":"#808080ff"},{"name":"neue deutsche welle","size":622.8130952380952,"fill":"#808080ff"},{"name":"ostrock","size":685.05,"fill":"#808080ff"}]},{"name":"german singer-songwriter","size":775.1992063492063,"fill":"#808080ff"},{"name":"oldschool deutschrap","size":1137.184257409257,"fill":"#808080ff"},{"name":"schlager","size":5530.42821067821,"fill":"#808080ff","children":[{"name":"discofox","size":1054.282142857143,"fill":"#808080ff"},{"name":"partyschlager","size":323.1282106782107,"fill":"#808080ff"}]}]},{"name":"german r&b","size":155.9507936507937,"fill":"#808080ff"},{"name":"german trap","size":302.8904761904762,"fill":"#808080ff"},{"name":"german underground rap","size":416.34112178671,"fill":"#808080ff"},{"name":"hamburg hip hop","size":904.1782439782439,"fill":"#808080ff"},{"name":"kurdish hip hop","size":167.6242063492063,"fill":"#808080ff"},{"name":"lo-fi jazzhop","size":158.6666666666667,"fill":"#808080ff"},{"name":"pop urbaine","size":55.40396825396825,"fill":"#808080ff"},{"name":"psychokore","size":517.7428571428571,"fill":"#808080ff","children":[{"name":"tekk","size":152.0119047619048,"fill":"#808080ff"}]},{"name":"reggae fusion","size":447.5615363996169,"fill":"#808080ff","children":[{"name":"jamaican dancehall","size":65.48666790725613,"fill":"#808080ff"},{"name":"reggae","size":179.0782399746796,"fill":"#808080ff","children":[{"name":"lovers rock","size":41.01493481578621,"fill":"#808080ff"},{"name":"modern reggae","size":42.14941432836169,"fill":"#808080ff"},{"name":"roots reggae","size":132.973842574694,"fill":"#808080ff"}]}]},{"name":"swedish hip hop","size":117.3674353424353,"fill":"#808080ff"},{"name":"turkish hip hop","size":218.0297008547008,"fill":"#808080ff","children":[{"name":"turkish pop","size":251.8666666666667,"fill":"#808080ff"}]},{"name":"uk hip hop","size":64.34606782106782,"fill":"#808080ff"}]},{"name":"rain","size":200.5,"fill":"#808080ff","children":[{"name":"white noise","size":112.5,"fill":"#808080ff"}]},{"name":"rock","size":4977.80621017871,"fill":"#808080ff","children":[{"name":"album rock","size":1947.662581128022,"fill":"#808080ff"},{"name":"alternative metal","size":2520.278690753691,"fill":"#808080ff","children":[{"name":"grunge","size":342.6928571428571,"fill":"#808080ff"},{"name":"industrial metal","size":790.3555555555555,"fill":"#808080ff","children":[{"name":"ebm","size":864.7992424242424,"fill":"#808080ff"}]},{"name":"melodic metalcore","size":835.3301587301587,"fill":"#808080ff"},{"name":"metalcore","size":763.2313492063493,"fill":"#808080ff"},{"name":"nu metal","size":1631.213539238539,"fill":"#808080ff"},{"name":"pop punk","size":488.9738095238095,"fill":"#808080ff","children":[{"name":"neon pop punk","size":155.0559523809524,"fill":"#808080ff"}]},{"name":"post-grunge","size":1210.344094794095,"fill":"#808080ff","children":[{"name":"pop rock","size":815.1739501239501,"fill":"#808080ff"}]}]},{"name":"alternative rock","size":1739.252560756237,"fill":"#808080ff","children":[{"name":"chamber pop","size":918.3865773115773,"fill":"#808080ff","children":[{"name":"indie folk","size":316.1529692529692,"fill":"#808080ff"}]},{"name":"electronica","size":955.2414904539904,"fill":"#808080ff","children":[{"name":"big beat","size":198.1321789321789,"fill":"#808080ff"},{"name":"breakbeat","size":131.0718253968254,"fill":"#808080ff"},{"name":"downtempo","size":634.3681027306027,"fill":"#808080ff"},{"name":"future garage","size":91.45543345543345,"fill":"#808080ff","children":[{"name":"classic dubstep","size":60.34166666666667,"fill":"#808080ff"}]},{"name":"intelligent dance music","size":262.0680014430014,"fill":"#808080ff"},{"name":"trip hop","size":706.1351583057466,"fill":"#808080ff"},{"name":"wonky","size":123.4977633477634,"fill":"#808080ff"}]},{"name":"noise pop","size":269.0578754578755,"fill":"#808080ff","children":[{"name":"neo-psychedelic","size":208.4114468864469,"fill":"#808080ff"}]}]},{"name":"britpop","size":1497.227380952381,"fill":"#808080ff"},{"name":"classic rock","size":2140.830474101062,"fill":"#808080ff","children":[{"name":"art rock","size":560.0080583632055,"fill":"#808080ff"},{"name":"blues rock","size":880.5271943742532,"fill":"#808080ff","children":[{"name":"blues","size":257.1146207550619,"fill":"#808080ff","children":[{"name":"traditional blues","size":100.996082512259,"fill":"#808080ff"}]},{"name":"british blues","size":404.4932321763204,"fill":"#808080ff"},{"name":"electric blues","size":408.0729180133592,"fill":"#808080ff"},{"name":"modern blues","size":395.2698384948385,"fill":"#808080ff"},{"name":"modern blues rock","size":561.3860532441415,"fill":"#808080ff"},{"name":"southern rock","size":211.8872132769192,"fill":"#808080ff"}]},{"name":"folk rock","size":630.6292542424895,"fill":"#808080ff"},{"name":"hollywood","size":90.53703975762799,"fill":"#808080ff"},{"name":"progressive rock","size":1929.016942371354,"fill":"#808080ff","children":[{"name":"jazz fusion","size":309.5222796596249,"fill":"#808080ff"}]},{"name":"psychedelic rock","size":438.5487373737374,"fill":"#808080ff","children":[{"name":"mpb","size":259.3799845141309,"fill":"#808080ff","children":[{"name":"bossa nova","size":169.3980981416957,"fill":"#808080ff"},{"name":"pagode","size":205.6671893147503,"fill":"#808080ff","children":[{"name":"sertanejo universitario","size":275.8928571428572,"fill":"#808080ff"}]},{"name":"samba","size":125.0305216802168,"fill":"#808080ff"}]}]},{"name":"rockabilly","size":465.6683372183372,"fill":"#808080ff"}]},{"name":"dance rock","size":588.5304806304806,"fill":"#808080ff"},{"name":"emo","size":211.4972582972583,"fill":"#808080ff"},{"name":"filmi","size":166.5030525030525,"fill":"#808080ff","children":[{"name":"modern bollywood","size":113.0372405372405,"fill":"#808080ff"}]},{"name":"filter house","size":124.4147546897547,"fill":"#808080ff"},{"name":"funk","size":304.3529442779443,"fill":"#808080ff","children":[{"name":"p funk","size":37.13784271284271,"fill":"#808080ff"},{"name":"post-disco","size":128.4631313131313,"fill":"#808080ff"}]},{"name":"glam rock","size":901.4730190561073,"fill":"#808080ff"},{"name":"hard rock","size":2829.357152161564,"fill":"#808080ff","children":[{"name":"glam metal","size":1352.294945740534,"fill":"#808080ff"}]},{"name":"mellow gold","size":1438.111237700208,"fill":"#808080ff"},{"name":"metal","size":2716.035591206179,"fill":"#808080ff","children":[{"name":"black metal","size":743.8095238095239,"fill":"#808080ff"},{"name":"death metal","size":891.3154761904761,"fill":"#808080ff","children":[{"name":"brutal death metal","size":299.5738095238095,"fill":"#808080ff"},{"name":"deathgrind","size":315.5404761904762,"fill":"#808080ff"}]},{"name":"german metal","size":1978.528715728716,"fill":"#808080ff","children":[{"name":"medieval rock","size":1939.833008658009,"fill":"#808080ff"},{"name":"neue deutsche harte","size":1737.051262626263,"fill":"#808080ff"}]},{"name":"groove metal","size":808.7210317460317,"fill":"#808080ff"},{"name":"melodic death metal","size":650.5801587301587,"fill":"#808080ff"},{"name":"power metal","size":2103.446572871573,"fill":"#808080ff","children":[{"name":"gothic metal","size":1246.329401154401,"fill":"#808080ff"},{"name":"hel","size":108.6445887445887,"fill":"#808080ff"}]},{"name":"progressive metal","size":1797.432142857143,"fill":"#808080ff"},{"name":"speed metal","size":1240.116017316017,"fill":"#808080ff"},{"name":"symphonic metal","size":1247.117929292929,"fill":"#808080ff","children":[{"name":"gothic symphonic metal","size":494.2000721500721,"fill":"#808080ff"}]},{"name":"thrash metal","size":811.7674963924964,"fill":"#808080ff"}]},{"name":"modern rock","size":1644.197052800141,"fill":"#808080ff","children":[{"name":"garage rock","size":546.6558584389467,"fill":"#808080ff"},{"name":"indie rock","size":692.5184125515008,"fill":"#808080ff","children":[{"name":"compositional ambient","size":329.9670634920635,"fill":"#808080ff","children":[{"name":"neo-classical","size":233.4666666666667,"fill":"#808080ff","children":[{"name":"background piano","size":158.5,"fill":"#808080ff"}]}]},{"name":"dance-punk","size":139.6246031746032,"fill":"#808080ff"},{"name":"new rave","size":196.3841991341991,"fill":"#808080ff"},{"name":"stomp and holler","size":238.0459817959818,"fill":"#808080ff"}]},{"name":"indietronica","size":749.886486552663,"fill":"#808080ff","children":[{"name":"alternative dance","size":273.6706894412777,"fill":"#808080ff"},{"name":"indie soul","size":275.4807432763315,"fill":"#808080ff"},{"name":"neo-synthpop","size":288.3176230632113,"fill":"#808080ff"},{"name":"shimmer pop","size":149.5161949161949,"fill":"#808080ff"}]},{"name":"modern alternative rock","size":342.5416594516594,"fill":"#808080ff"},{"name":"pov: indie","size":217.2500360750361,"fill":"#808080ff"}]},{"name":"new wave pop","size":2541.333373978962,"fill":"#808080ff","children":[{"name":"australian dance","size":150.8220014462661,"fill":"#808080ff"},{"name":"british soul","size":648.2118829699712,"fill":"#808080ff"},{"name":"eurodance","size":1241.055032467533,"fill":"#808080ff","children":[{"name":"diva house","size":169.3163059163059,"fill":"#808080ff"},{"name":"hands up","size":157.2242424242424,"fill":"#808080ff"},{"name":"hip house","size":300.2476551226551,"fill":"#808080ff"}]},{"name":"new romantic","size":1578.535532523033,"fill":"#808080ff"},{"name":"new wave","size":1147.311387223887,"fill":"#808080ff"},{"name":"solo wave","size":537.8380341880342,"fill":"#808080ff"},{"name":"sophisti-pop","size":624.2479076479076,"fill":"#808080ff"},{"name":"synthpop","size":1312.787262737263,"fill":"#808080ff"}]},{"name":"permanent wave","size":2340.956914735591,"fill":"#808080ff","children":[{"name":"power pop","size":252.8062271062271,"fill":"#808080ff","children":[{"name":"underground power pop","size":54.26666666666667,"fill":"#808080ff"}]}]},{"name":"pop","size":4264.329168798415,"fill":"#808080ff","children":[{"name":"alt z","size":196.5189976689977,"fill":"#808080ff"},{"name":"anime","size":315.75,"fill":"#808080ff","children":[{"name":"j-pop","size":217.9761904761905,"fill":"#808080ff"},{"name":"j-rock","size":199.9166666666667,"fill":"#808080ff"}]},{"name":"boy band","size":999.7104367854367,"fill":"#808080ff"},{"name":"canadian contemporary r&b","size":61.04269798828622,"fill":"#808080ff"},{"name":"canadian pop","size":685.4823089878818,"fill":"#808080ff","children":[{"name":"chanson","size":542.0107142857142,"fill":"#808080ff","children":[{"name":"french pop","size":219.45,"fill":"#808080ff"}]}]},{"name":"candy pop","size":266.9903243815008,"fill":"#808080ff"},{"name":"dance pop","size":2231.32841842257,"fill":"#808080ff","children":[{"name":"australian pop","size":285.607215007215,"fill":"#808080ff"},{"name":"europop","size":1476.157671957672,"fill":"#808080ff","children":[{"name":"italo disco","size":392.4928571428571,"fill":"#808080ff"},{"name":"swedish pop","size":350.7350001305884,"fill":"#808080ff","children":[{"name":"classic swedish pop","size":273.7373015873016,"fill":"#808080ff"},{"name":"swedish electropop","size":56.34176460794108,"fill":"#808080ff"}]}]},{"name":"girl group","size":339.574488011988,"fill":"#808080ff"},{"name":"hip pop","size":309.7160010528604,"fill":"#808080ff"},{"name":"latin pop","size":495.9760770388052,"fill":"#808080ff","children":[{"name":"colombian pop","size":72.28872573786367,"fill":"#808080ff"},{"name":"mexican pop","size":345.9177750410509,"fill":"#808080ff","children":[{"name":"latin arena pop","size":98.22337164750958,"fill":"#808080ff"}]},{"name":"musica mexicana","size":58.57063492063492,"fill":"#808080ff","children":[{"name":"norteno","size":45,"fill":"#808080ff"}]},{"name":"salsa","size":156.0000360750361,"fill":"#808080ff"},{"name":"spanish pop","size":63.06226053639847,"fill":"#808080ff"},{"name":"tropical","size":106.8417027417027,"fill":"#808080ff"},{"name":"urbano latino","size":172.0740480717507,"fill":"#808080ff","children":[{"name":"latin hip hop","size":87.68625516048789,"fill":"#808080ff"},{"name":"reggaeton colombiano","size":22.80445257919903,"fill":"#808080ff"},{"name":"trap latino","size":122.9435111640963,"fill":"#808080ff"}]}]},{"name":"neo mellow","size":1033.148974119562,"fill":"#808080ff","children":[{"name":"acoustic pop","size":126.094733044733,"fill":"#808080ff"}]},{"name":"r&b","size":899.920423101541,"fill":"#808080ff","children":[{"name":"afrofuturism","size":102.1493750530515,"fill":"#808080ff"},{"name":"alternative r&b","size":163.7308198939004,"fill":"#808080ff"},{"name":"contemporary r&b","size":322.5922102136378,"fill":"#808080ff"},{"name":"neo soul","size":555.4569081907085,"fill":"#808080ff"},{"name":"new jack swing","size":120.0847222639089,"fill":"#808080ff"},{"name":"uk contemporary r&b","size":71.81071428571428,"fill":"#808080ff"}]},{"name":"urban contemporary","size":686.9196509376884,"fill":"#808080ff"}]},{"name":"dancehall","size":218.6396383690269,"fill":"#808080ff"},{"name":"edm","size":356.0357208866777,"fill":"#808080ff","children":[{"name":"brostep","size":94.78269950150755,"fill":"#808080ff","children":[{"name":"filthstep","size":90.3752886002886,"fill":"#808080ff"}]},{"name":"canadian electronic","size":35.89687016200174,"fill":"#808080ff"},{"name":"complextro","size":84.14084567393391,"fill":"#808080ff"},{"name":"dutch house","size":86.83024508314756,"fill":"#808080ff"},{"name":"dutch trance","size":44.73328774195647,"fill":"#808080ff"},{"name":"electro house","size":180.5434162214348,"fill":"#808080ff"},{"name":"house","size":140.9598114805158,"fill":"#808080ff"},{"name":"progressive electro house","size":140.7722585335201,"fill":"#808080ff"},{"name":"progressive house","size":122.0343058042748,"fill":"#808080ff"}]},{"name":"electropop","size":267.3680558004087,"fill":"#808080ff"},{"name":"german techno","size":1217.408218170718,"fill":"#808080ff","children":[{"name":"bubble trance","size":531.2805916305916,"fill":"#808080ff"},{"name":"deep euro house","size":235.3945526695527,"fill":"#808080ff"},{"name":"german dance","size":312.4915584415584,"fill":"#808080ff"},{"name":"minimal techno","size":292.575,"fill":"#808080ff","children":[{"name":"acid house","size":61.34209956709957,"fill":"#808080ff"},{"name":"deep disco house","size":45.76190476190476,"fill":"#808080ff"},{"name":"microhouse","size":71.02857142857142,"fill":"#808080ff"},{"name":"minimal tech house","size":45.69404761904762,"fill":"#808080ff"},{"name":"techno","size":117.2496031746032,"fill":"#808080ff"}]},{"name":"trance","size":319.2339875108838,"fill":"#808080ff","children":[{"name":"uplifting trance","size":84.59265913824737,"fill":"#808080ff"}]}]},{"name":"gospel","size":275.8462560386474,"fill":"#808080ff"},{"name":"hip hop","size":1374.264878183866,"fill":"#808080ff","children":[{"name":"alternative hip hop","size":178.9307805326768,"fill":"#808080ff"},{"name":"conscious hip hop","size":219.8841242883886,"fill":"#808080ff"},{"name":"detroit hip hop","size":171.0271094679966,"fill":"#808080ff"},{"name":"dirty south rap","size":118.6598777204852,"fill":"#808080ff","children":[{"name":"crunk","size":16.70157079332776,"fill":"#808080ff"}]},{"name":"east coast hip hop","size":549.9472358161956,"fill":"#808080ff","children":[{"name":"battle rap","size":14.62550443622425,"fill":"#808080ff"},{"name":"bronx hip hop","size":26.43836649956585,"fill":"#808080ff"}]},{"name":"g funk","size":134.1849027495525,"fill":"#808080ff"},{"name":"gangster rap","size":421.05418705087,"fill":"#808080ff"},{"name":"golden age hip hop","size":119.4079567203709,"fill":"#808080ff"},{"name":"hardcore hip hop","size":294.4001425600702,"fill":"#808080ff"},{"name":"new jersey rap","size":56.45262595442128,"fill":"#808080ff"},{"name":"old school atlanta hip hop","size":45.70793998665316,"fill":"#808080ff"},{"name":"old school hip hop","size":104.075639971521,"fill":"#808080ff"},{"name":"philly rap","size":62.86967601112338,"fill":"#808080ff"},{"name":"queens hip hop","size":131.5603958081822,"fill":"#808080ff"},{"name":"trap soul","size":15.3244847962495,"fill":"#808080ff"},{"name":"west coast rap","size":242.8819034082169,"fill":"#808080ff"}]},{"name":"indie poptimism","size":79.15479797979798,"fill":"#808080ff"},{"name":"k-pop","size":368.1473304473304,"fill":"#808080ff"},{"name":"metropopolis","size":409.5950898774428,"fill":"#808080ff"},{"name":"miami hip hop","size":98.43917783798588,"fill":"#808080ff"},{"name":"pop dance","size":373.5349365345776,"fill":"#808080ff","children":[{"name":"big room","size":78.38303544862075,"fill":"#808080ff"},{"name":"classic hardstyle","size":143.8376845376845,"fill":"#808080ff","children":[{"name":"rawstyle","size":98.25440115440115,"fill":"#808080ff"}]},{"name":"deep house","size":120.2298701298701,"fill":"#808080ff","children":[{"name":"classic house","size":66.08611111111111,"fill":"#808080ff"},{"name":"disco house","size":51.14325396825397,"fill":"#808080ff"},{"name":"vocal house","size":33.54188034188034,"fill":"#808080ff"}]},{"name":"euphoric hardstyle","size":126.0364940614941,"fill":"#808080ff"},{"name":"melbourne bounce","size":19.45531612780065,"fill":"#808080ff"},{"name":"pop edm","size":32.818725207541,"fill":"#808080ff"},{"name":"slap house","size":112.1402487178571,"fill":"#808080ff","children":[{"name":"hypertechno","size":132.1512265512266,"fill":"#808080ff"}]},{"name":"tropical house","size":93.65752482811307,"fill":"#808080ff"},{"name":"uk dance","size":128.1880885024848,"fill":"#808080ff","children":[{"name":"drum and bass","size":197.4563852813853,"fill":"#808080ff","children":[{"name":"liquid funk","size":57.03333333333333,"fill":"#808080ff"}]}]}]},{"name":"pop r&b","size":37.60809190809191,"fill":"#808080ff"},{"name":"pop soul","size":279.3993043506201,"fill":"#808080ff"},{"name":"post-teen pop","size":325.9852480852481,"fill":"#808080ff"},{"name":"rap","size":1582.576436296152,"fill":"#808080ff","children":[{"name":"atl hip hop","size":319.1151461971953,"fill":"#808080ff"},{"name":"atl trap","size":29.09243917846859,"fill":"#808080ff"},{"name":"cali rap","size":23.95476041416444,"fill":"#808080ff"},{"name":"canadian hip hop","size":75.69558331675205,"fill":"#808080ff"},{"name":"chicago rap","size":127.8326096684533,"fill":"#808080ff"},{"name":"melodic rap","size":237.140804175185,"fill":"#808080ff"},{"name":"memphis hip hop","size":13.2960740240152,"fill":"#808080ff"},{"name":"new orleans rap","size":53.09720462028512,"fill":"#808080ff"},{"name":"pop rap","size":745.0768599462058,"fill":"#808080ff","children":[{"name":"grime","size":49.66706349206349,"fill":"#808080ff"}]},{"name":"southern hip hop","size":281.7357487302804,"fill":"#808080ff"},{"name":"trap","size":411.9497427367067,"fill":"#808080ff"},{"name":"trap queen","size":49.42038489288489,"fill":"#808080ff"},{"name":"underground hip hop","size":51.94165001665002,"fill":"#808080ff"}]},{"name":"reggaeton","size":190.2768759112165,"fill":"#808080ff"},{"name":"singer-songwriter pop","size":164.0853535353535,"fill":"#808080ff"},{"name":"uk pop","size":721.1450724112489,"fill":"#808080ff"},{"name":"viral pop","size":268.0468253968254,"fill":"#808080ff"}]},{"name":"punk","size":1243.346825396825,"fill":"#808080ff","children":[{"name":"ska","size":271.9833333333333,"fill":"#808080ff"},{"name":"skate punk","size":663.1777777777778,"fill":"#808080ff"}]},{"name":"singer-songwriter","size":1825.244504433475,"fill":"#808080ff","children":[{"name":"alternative country","size":230.6067173023055,"fill":"#808080ff"},{"name":"art pop","size":760.9778839409644,"fill":"#808080ff","children":[{"name":"indie pop","size":150.4162198912199,"fill":"#808080ff"}]},{"name":"country","size":320.9485975135975,"fill":"#808080ff","children":[{"name":"classic country pop","size":57.49381396381396,"fill":"#808080ff"},{"name":"contemporary country","size":224.7825541125541,"fill":"#808080ff","children":[{"name":"modern country rock","size":41.45519480519481,"fill":"#808080ff"}]},{"name":"country dawn","size":113.0939582639583,"fill":"#808080ff"},{"name":"country road","size":182.040101010101,"fill":"#808080ff"}]},{"name":"country rock","size":324.1289510815981,"fill":"#808080ff"},{"name":"ectofolk","size":280.6796398046398,"fill":"#808080ff"},{"name":"folk","size":633.5775073782427,"fill":"#808080ff","children":[{"name":"bluegrass","size":117.3782429988312,"fill":"#808080ff"},{"name":"progressive bluegrass","size":139.5672761878644,"fill":"#808080ff"}]},{"name":"heartland rock","size":550.5183959831019,"fill":"#808080ff"},{"name":"lilith","size":480.9676582132465,"fill":"#808080ff"},{"name":"melancholia","size":791.2890553890554,"fill":"#808080ff"},{"name":"movie tunes","size":236.0868215118215,"fill":"#808080ff","children":[{"name":"broadway","size":84.57176157176157,"fill":"#808080ff"},{"name":"show tunes","size":59.95168165168165,"fill":"#808080ff"}]},{"name":"new americana","size":102.7380341880342,"fill":"#808080ff"},{"name":"outlaw country","size":134.3775392581275,"fill":"#808080ff"},{"name":"piano rock","size":396.347551060051,"fill":"#808080ff"},{"name":"roots rock","size":343.9882993640347,"fill":"#808080ff"}]},{"name":"soft rock","size":2781.303690019131,"fill":"#808080ff","children":[{"name":"adult standards","size":484.8247585747586,"fill":"#808080ff","children":[{"name":"lounge","size":135.9087662337662,"fill":"#808080ff"},{"name":"rock-and-roll","size":311.7246503496503,"fill":"#808080ff"}]},{"name":"disco","size":465.9262737262737,"fill":"#808080ff"},{"name":"operatic pop","size":777.8077999185198,"fill":"#808080ff","children":[{"name":"canzone napoletana","size":15.00196963768945,"fill":"#808080ff"},{"name":"classical","size":301.9432211922924,"fill":"#808080ff","children":[{"name":"chamber orchestra","size":27.50793650793651,"fill":"#808080ff"},{"name":"classical cello","size":45.03102453102453,"fill":"#808080ff"},{"name":"classical performance","size":161.9343945227459,"fill":"#808080ff"},{"name":"classical piano","size":157.6063492063492,"fill":"#808080ff"},{"name":"early modern classical","size":51.34527417027417,"fill":"#808080ff"},{"name":"orchestra","size":104.4493324056404,"fill":"#808080ff","children":[{"name":"british orchestra","size":64.03869365928189,"fill":"#808080ff"},{"name":"german orchestra","size":21.23543298806457,"fill":"#808080ff"}]},{"name":"orchestral performance","size":51.8254544861743,"fill":"#808080ff"},{"name":"post-romantic era","size":54.48076069956875,"fill":"#808080ff"},{"name":"soundtrack","size":419.8254329004329,"fill":"#808080ff"},{"name":"violin","size":95.59194139194139,"fill":"#808080ff"}]},{"name":"classical tenor","size":191.2151238209675,"fill":"#808080ff"},{"name":"italian tenor","size":99.07108728474827,"fill":"#808080ff"},{"name":"opera","size":168.2502778997748,"fill":"#808080ff","children":[{"name":"classical soprano","size":52.87267069016295,"fill":"#808080ff"},{"name":"italian orchestra","size":25.52751039809863,"fill":"#808080ff"}]},{"name":"pop violin","size":227.4154761904762,"fill":"#808080ff","children":[{"name":"bow pop","size":273.0202380952381,"fill":"#808080ff"}]}]},{"name":"soul","size":441.5127615633421,"fill":"#808080ff","children":[{"name":"classic soul","size":71.22318237318237,"fill":"#808080ff"},{"name":"jazz funk","size":104.1645424020424,"fill":"#808080ff"},{"name":"motown","size":150.757196969697,"fill":"#808080ff"},{"name":"quiet storm","size":153.1391788766789,"fill":"#808080ff"},{"name":"southern soul","size":50.33738483738484,"fill":"#808080ff"}]},{"name":"vocal jazz","size":422.8088609876535,"fill":"#808080ff","children":[{"name":"contemporary vocal jazz","size":475.8901154401154,"fill":"#808080ff"},{"name":"jazz","size":196.561318042123,"fill":"#808080ff","children":[{"name":"bebop","size":88.02988934010605,"fill":"#808080ff"},{"name":"contemporary post-bop","size":116.8200844434204,"fill":"#808080ff"},{"name":"jazz piano","size":82.37914050603679,"fill":"#808080ff"},{"name":"jazz saxophone","size":123.2011781905745,"fill":"#808080ff"}]},{"name":"jazz pop","size":271.5020202020202,"fill":"#808080ff"},{"name":"jazz trumpet","size":214.658158710055,"fill":"#808080ff"}]},{"name":"yacht rock","size":344.7460561497326,"fill":"#808080ff"}]},{"name":"world","size":472.026862026862,"fill":"#808080ff","children":[{"name":"afropop","size":222.6219988344988,"fill":"#808080ff","children":[{"name":"afrobeats","size":47.74987373737373,"fill":"#808080ff"},{"name":"nigerian pop","size":33.59944083694084,"fill":"#808080ff"}]},{"name":"latin alternative","size":175.1190476190476,"fill":"#808080ff"}]}]}]},"weights":{"key":["acid house->minimal techno","acoustic pop->neo mellow","adult standards->soft rock","afrobeats->afropop","afrofuturism->r&b","afropop->world","albanian hip hop->german hip hop","albanian pop->german hip hop","album rock->rock","alt z->pop","alternative country->singer-songwriter","alternative dance->indietronica","alternative hip hop->hip hop","alternative metal->rock","alternative r&b->r&b","alternative rock->rock","anime->pop","antideutsche->german indie","art pop->singer-songwriter","art rock->classic rock","atl hip hop->rap","atl trap->rap","australian dance->new wave pop","australian pop->dance pop","austropop->classic schlager","background piano->neo-classical","battle rap->east coast hip hop","bebop->jazz","big beat->electronica","big room->pop dance","black metal->metal","bluegrass->folk","blues->blues rock","blues rock->classic rock","bossa nova->mpb","bow pop->pop violin","boy band->pop","breakbeat->electronica","british blues->blues rock","british orchestra->orchestra","british soul->new wave pop","britpop->rock","broadway->movie tunes","bronx hip hop->east coast hip hop","brostep->edm","brutal death metal->death metal","bubble trance->german techno","cali rap->rap","canadian contemporary r&b->pop","canadian electronic->edm","canadian hip hop->rap","canadian pop->pop","candy pop->pop","canzone napoletana->operatic pop","chamber orchestra->classical","chamber pop->alternative rock","chanson->canadian pop","chicago rap->rap","classic cantopop->cantopop","classic country pop->country","classic dubstep->future garage","classic hardstyle->pop dance","classic house->deep house","classic rock->rock","classic schlager->german pop","classic soul->soul","classic swedish pop->swedish pop","classical->operatic pop","classical cello->classical","classical performance->classical","classical piano->classical","classical soprano->opera","classical tenor->operatic pop","cologne hip hop->german hip hop","colombian pop->latin pop","complextro->edm","compositional ambient->indie rock","conscious hip hop->hip hop","contemporary country->country","contemporary post-bop->jazz","contemporary r&b->r&b","contemporary vocal jazz->vocal jazz","country->singer-songwriter","country dawn->country","country road->country","country rock->singer-songwriter","crunk->dirty south rap","dance pop->pop","dance rock->rock","dance-punk->indie rock","dancehall->pop","death metal->metal","deathgrind->death metal","deep disco house->minimal techno","deep euro house->german techno","deep german hip hop->german hip hop","deep house->pop dance","detroit hip hop->hip hop","deutschrock->german rock","dirty south rap->hip hop","disco->soft rock","disco house->deep house","discofox->schlager","diva house->eurodance","downtempo->electronica","drum and bass->uk dance","dutch house->edm","dutch trance->edm","early modern classical->classical","east coast hip hop->hip hop","easy listening->classic schlager","ebm->industrial metal","ectofolk->singer-songwriter","edm->pop","electric blues->blues rock","electro house->edm","electronica->alternative rock","electropop->pop","emo->rock","euphoric hardstyle->pop dance","eurodance->new wave pop","europop->dance pop","filmi->rock","filter house->rock","filthstep->brostep","folk->singer-songwriter","folk rock->classic rock","frauenrap->german hip hop","french hip hop->german hip hop","french pop->chanson","funk->rock","future garage->electronica","g funk->hip hop","gangster rap->hip hop","garage rock->modern rock","german alternative rap->german hip hop","german cloud rap->german hip hop","german dance->german techno","german drill->german hip hop","german indie->german pop","german metal->metal","german orchestra->orchestra","german pop->german hip hop","german punk->german rock","german r&b->german hip hop","german reggae->german pop","german rock->german pop","german singer-songwriter->german pop","german techno->pop","german trap->german hip hop","german underground rap->german hip hop","girl group->dance pop","glam metal->hard rock","glam rock->rock","golden age hip hop->hip hop","gospel->pop","gothic metal->power metal","gothic symphonic metal->symphonic metal","grime->pop rap","groove metal->metal","grunge->alternative metal","hamburg hip hop->german hip hop","hands up->eurodance","hard rock->rock","hardcore hip hop->hip hop","heartland rock->singer-songwriter","hel->power metal","hip hop->pop","hip house->eurodance","hip pop->dance pop","hollywood->classic rock","house->edm","hypertechno->slap house","indie folk->chamber pop","indie pop->art pop","indie poptimism->pop","indie rock->modern rock","indie soul->indietronica","indietronica->modern rock","industrial metal->alternative metal","intelligent dance music->electronica","italian orchestra->opera","italian tenor->operatic pop","italo disco->europop","j-pop->anime","j-rock->anime","jamaican dancehall->reggae fusion","jazz->vocal jazz","jazz funk->soul","jazz fusion->progressive rock","jazz piano->jazz","jazz pop->vocal jazz","jazz saxophone->jazz","jazz trumpet->vocal jazz","k-pop->pop","kabarett->german rock","kurdish hip hop->german hip hop","latin alternative->world","latin arena pop->mexican pop","latin hip hop->urbano latino","latin pop->dance pop","liedermacher->german rock","lilith->singer-songwriter","liquid funk->drum and bass","lo-fi jazzhop->german hip hop","lounge->adult standards","lovers rock->reggae","mandopop->cantopop","medieval rock->german metal","melancholia->singer-songwriter","melbourne bounce->pop dance","mellow gold->rock","melodic death metal->metal","melodic metalcore->alternative metal","melodic rap->rap","memphis hip hop->rap","metal->rock","metalcore->alternative metal","metropopolis->pop","mexican pop->latin pop","miami hip hop->pop","microhouse->minimal techno","minimal tech house->minimal techno","minimal techno->german techno","modern alternative rock->modern rock","modern blues->blues rock","modern blues rock->blues rock","modern bollywood->filmi","modern country rock->contemporary country","modern reggae->reggae","modern rock->rock","motown->soul","movie tunes->singer-songwriter","mpb->psychedelic rock","musica mexicana->latin pop","neo mellow->dance pop","neo soul->r&b","neo-classical->compositional ambient","neo-psychedelic->noise pop","neo-synthpop->indietronica","neon pop punk->pop punk","neue deutsche harte->german metal","neue deutsche welle->german rock","new americana->singer-songwriter","new jack swing->r&b","new jersey rap->hip hop","new orleans rap->rap","new rave->indie rock","new romantic->new wave pop","new wave->new wave pop","new wave pop->rock","nigerian pop->afropop","noise pop->alternative rock","norteno->musica mexicana","nu metal->alternative metal","old school atlanta hip hop->hip hop","old school hip hop->hip hop","oldschool deutschrap->german pop","opera->operatic pop","operatic pop->soft rock","orchestra->classical","orchestral performance->classical","ostrock->german rock","outlaw country->singer-songwriter","p funk->funk","pagode->mpb","partyschlager->schlager","permanent wave->rock","philly rap->hip hop","piano rock->singer-songwriter","pop->rock","pop dance->pop","pop edm->pop dance","pop punk->alternative metal","pop r&b->pop","pop rap->rap","pop rock->post-grunge","pop soul->pop","pop urbaine->german hip hop","pop violin->operatic pop","post-disco->funk","post-grunge->alternative metal","post-romantic era->classical","post-teen pop->pop","pov: indie->modern rock","power metal->metal","power pop->permanent wave","progressive bluegrass->folk","progressive electro house->edm","progressive house->edm","progressive metal->metal","progressive rock->classic rock","psychedelic rock->classic rock","psychokore->german hip hop","punk->rock","queens hip hop->hip hop","quiet storm->soul","r&b->dance pop","rap->pop","rawstyle->classic hardstyle","reggae->reggae fusion","reggae fusion->german hip hop","reggaeton->pop","reggaeton colombiano->urbano latino","rock-and-roll->adult standards","rockabilly->classic rock","roots reggae->reggae","roots rock->singer-songwriter","salsa->latin pop","samba->mpb","schlager->german pop","sertanejo universitario->pagode","shimmer pop->indietronica","show tunes->movie tunes","singer-songwriter->rock","singer-songwriter pop->pop","ska->punk","skate punk->punk","slap house->pop dance","soft rock->rock","solo wave->new wave pop","sophisti-pop->new wave pop","soul->soft rock","soundtrack->classical","southern hip hop->rap","southern rock->blues rock","southern soul->soul","spanish pop->latin pop","speed metal->metal","stomp and holler->indie rock","swedish electropop->swedish pop","swedish hip hop->german hip hop","swedish pop->europop","symphonic metal->metal","synthpop->new wave pop","techno->minimal techno","tekk->psychokore","thrash metal->metal","traditional blues->blues","trance->german techno","trap->rap","trap latino->urbano latino","trap queen->rap","trap soul->hip hop","trip hop->electronica","tropical->latin pop","tropical house->pop dance","turkish hip hop->german hip hop","turkish pop->turkish hip hop","uk contemporary r&b->r&b","uk dance->pop dance","uk hip hop->german hip hop","uk pop->pop","underground hip hop->rap","underground power pop->power pop","uplifting trance->trance","urban contemporary->dance pop","urbano latino->latin pop","violin->classical","viral pop->pop","vocal house->deep house","vocal jazz->soft rock","volksmusik->classic schlager","west coast rap->hip hop","white noise->rain","wonky->electronica","world->rock","yacht rock->soft rock","background jazz->POPULAR MUSIC","cantopop->POPULAR MUSIC","classic persian pop->POPULAR MUSIC","german hip hop->POPULAR MUSIC","rain->POPULAR MUSIC","rock->POPULAR MUSIC"],"weight":[0.3356413848308986,0.5353872258699093,0.4130563279292238,0.3063063063063063,0.2762196380851021,0.2620247366010078,0.9227162992431071,0.8236096616263781,0.4106765467703823,0.4938113448540648,0.4443452560064728,0.3598176532769556,0.3644450837311972,0.265110598420559,0.2843144130546366,0.3995086689716452,0.00275111717946487,0.1365677993383693,0.1848293848453124,0.4925386640149285,0.5830639203131304,0.9500962438872125,0.4146552602097973,0.3930458268099625,0.2516341704087418,0.003063501724487726,0.7112141408287453,0.5229203578064907,0.4938124709077338,0.678130008315142,0.5621403394299814,0.1972900498454161,0.577860841985239,0.3490471488085188,0.1338203935252495,0.1010575793184488,0.2392923071858076,0.3847375321292414,0.5454715726641901,0.3472481754398336,0.2747285319030838,0.2026680592928812,0.1475309689462074,0.8548052294162065,0.6009043909263165,0.6226123619416879,0.295131845841785,0.7123270211216315,0.8564996084573219,0.5233383737323207,0.8785057531477973,0.2667162315391233,0.3241900763759569,0.9012624128795339,0.5017575928008999,0.141499774629364,0.01050227536457458,0.7750295100082879,0.308348819602175,0.6262631058358061,0.2020411693478637,0.05044747268313917,0.2467661691542288,0.3768886273661379,0.0138694291453358,0.7721266445479056,0.2841426002327304,0.06408716245615458,0.3716722909636296,0.2393046949437248,0.3201145311381531,0.5958404501155431,0.3868042456719317,0.6601112183913279,0.6716199095022625,0.6290252564298678,0.2086670115342177,0.720649623508659,0.2416456948252764,0.3580737059037459,0.4972975608618549,0.1568664484176949,0.1192680827850851,0.547900669240031,0.3779108613201799,0.5855595435363861,0.7245940521802591,0.1777525471870477,0.3532266203315978,0.4538470006463349,0.2276914580030687,0.572053020684671,0.6412919733534723,0.4536855446601294,0.1917999170081018,0.4028055816975286,0.2387402953800927,0.8242354953176678,0.1203792812386404,0.6298077151900241,0.4692750851761114,0.2059506389620525,0.7179612924743601,0.3128504148912312,0.3521226505724522,0.06253101736972705,0.6674148818796272,0.7086754161394422,0.519941951700482,0.519693094629156,0.218916119743641,0.2302639077804543,0.5480197767415019,0.2764243809453669,0.488860527806932,0.4426637743296073,0.04021541611302044,0.2283118030622701,0.4259149169075815,0.05540048758082182,0.08336726779832711,0.08995471815536178,0.007028836295936962,0.2627561484627275,0.3144853539678009,0.5716734566784648,0.5363388748004132,0.8218521875400462,0.2254672323959811,0.2536924927530516,0.3288488649260154,0.5050494668452795,0.8364004564881738,0.5886760438954334,0.418485282161512,0.3175481849799815,0.6383541856276935,0.2431234546604566,0.8495185071688814,0.1020966628209923,0.222693764938617,0.6993504048201845,0.008781545175598968,0.3832819280271027,0.5989479536142727,0.2933348800461129,0.1470122247293045,0.5753516265388026,0.009575113042160306,0.9000530591325711,0.7033145490777988,0.2991542354279503,0.5483024987457659,0.5482107641006777,0.8259139312518967,0.01359447130786207,0.225779398378226,0.5736050384745721,0.2520818194888613,0.5484113289267316,0.6644736850621591,0.4475521666404821,0.4841786171759879,0.2656246067974438,0.6668843105043223,0.5008349774141035,0.7221845753562969,0.02601968397163987,0.4036117286356979,0.4103021139917722,0.1505957412550819,0.4618959052175661,0.1104002749980903,0.3046511130428357,0.5038654812524159,0.5424148358554847,0.2162153938179669,0.2195594014631257,0.1464900954381152,0.4160359487513766,0.5594646598056646,0.6718264367115607,0.7168643026258066,0.2083376021266104,0.02427845906106776,0.03080547250158558,0.5911378943637009,0.1372042341220423,0.2456499523447419,0.3723049391729288,0.5125360490266763,0.222137721238938,0.3311340974746062,0.2074612308987309,0.403265035318585,0.3295865132840953,0.9650161110015124,0.1823816576161483,0.4352297318185331,0.3392066234574939,0.2170848796899217,0.3645721462081507,0.4975442977611632,0.5249327956989247,0.06554170915264927,0.6521236396614267,0.5225281602002504,0.01761694003297753,0.1495537909103471,0.2592940882825631,0.7551805341223885,0.4118150383634193,0.5539796206672734,0.2766221311729963,0.8235443473334951,0.831412431385785,0.09314943747872367,0.2607003748738806,0.2548711980146833,0.1994617975960293,0.4798160761150873,0.5748707651557227,0.4727836702021213,0.3791420456321864,0.6060849351914114,0.4502907997970256,0.257411964979183,0.1616112667524797,0.7399939722724532,0.466399831472509,0.3778976473062942,0.6104503970001344,0.1979211773546722,0.01003452149373955,0.08914434796787737,0.08419711102908733,0.2557707993474714,0.224390707397026,0.2010802716722819,0.4115111107080381,0.5958968523210375,0.1619935503372753,0.5121465012569333,0.3929918332660701,0.6447327535805256,0.59458894406008,0.7275327946655589,0.4133462197757096,0.2022228021090763,0.2880094678573938,0.07020279920411393,0.3863904888495053,0.4509909979455146,0.2087604846225536,0.3413550418234799,0.8695117787640834,0.7387971519466747,0.3196005406961664,0.182733592958284,0.133714197120807,0.2827577968683118,0.4808058786466125,0.6125745012491551,0.545644877027147,0.6687645830774899,0.09024751368868028,0.6372791183735512,0.3534150246796908,0.7441520203753544,0.3989535936896524,0.02373813563934793,0.2772926679992928,0.5988440425934648,0.4122600711024802,0.5899677067093891,0.3441620132229919,0.139508511175251,0.2999408185492219,0.335386701118549,0.2271103955757253,0.262146517365724,0.4537147801660881,0.5071344805303593,0.6575870087313566,0.4862784679941728,0.2464370121645713,0.4426223016642389,0.1860481369851046,0.5454542039480316,0.5416998396709336,0.2667456192794315,0.2888724523339908,0.6040868582513559,0.08661100534505219,0.2285771901705553,0.7130523600758862,0.4638211986982118,0.1770059419208801,0.04811521963177308,0.2272516323997625,0.1763229678123295,0.1958158945020259,0.1083368471778809,0.7746914926089042,0.1588206290135124,0.08610890115415003,0.2164967289444215,0.5790965843920464,0.252508504805628,0.1944049312470365,0.01981841720631153,0.004139090022614589,0.5562070886803984,0.1873335249592795,0.2457135198545476,0.4868803934678713,0.4612668622939052,0.4095348128234798,0.3511069449422403,0.2252521109744465,0.2107865451928223,0.5354222547644634,0.1636615669628135,0.01276520679314271,0.6055081452572142,0.5526617134610433,0.7857135078328769,0.5037466063348416,0.478060981039516,0.414722313250004,0.5339720194647202,0.7825416938555624,0.2714706492132373,0.2633270653993677,0.2964461731155911,0.4565848600069132,0.2651316773903936,0.6366877536841336,0.6404758425258221,0.3492798301147447,0.5932916476159186,0.1659495198614682,0.4681734443098566,0.9284778663299929,0.2714571372685847,0.3826636864198877,0.6933373100343067,0.9157539716424127,0.0401889921461873,0.2645373629833147,0.3861909175162187,0.1587840882244775,0.5149114511174026,0.5194095900135525,0.5526416392690573,0.6947826947826948,0.3244938497881545,0.1266730173850917,0.3241469816272966,0.3313235636959238,0.2489683933274802,0.08109055816629904,0.5523237630132855,0.7787101195461814,0.02603110209601082,0.5208033935910042,0.005472514661158361,0.7256067757132471,0,0,0,0,0,0]},"margin_left":150,"margin_right":350,"margin_top":0,"margin_bottom":0,"min_font_size":22,"max_font_size":36},"type":"list","container":"svg","options":{"container":"div","viewer":null},"script":"var d3Script = function(d3, r2d3, data, svg, width, height, options, theme, console) {\nthis.d3 = d3;\n\nsvg = d3.select(svg.node());\n/* R2D3 Source File:  N:/Materialien/Promotion/GenreDiscourseAnalysis/inst/d3/interactive_network_plot.js */\n// Interactive Network Plot - Fully responsive dimensions\nconst minNodeSpacing = 30; // Minimum spacing between nodes to prevent overlap\n\n// Get responsive width from container with timing-safe approach\nconst getResponsiveWidth = () => {\n    // Try multiple ways to get the container width\n    const svgNode = svg.node();\n    const computedStyle = window.getComputedStyle(svgNode);\n    if (computedStyle.width && computedStyle.width !== \"auto\") {\n        const width = parseFloat(computedStyle.width);\n        if (width > 0) {\n            return width - 4;\n        }\n    }\n\n    // Fallback to viewport width\n    console.log(\"Using viewport fallback width\");\n    return window.innerWidth * 0.8;\n};\n\n// Use responsive dimensions - prioritize container dimensions over r2d3 data\nconst actualHeight = (data.height || 1000) - 4; // Reduce by 4px for borders/padding\nconst actualWidth = getResponsiveWidth();\n\n// Calculate dynamic height based on tree structure\nfunction calculateRequiredHeight(root) {\n    const visibleNodes = root.descendants();\n    const nodesByDepth = {};\n\n    // Group nodes by depth level\n    visibleNodes.forEach(node => {\n        const depth = node.depth;\n        if (!nodesByDepth[depth]) {\n            nodesByDepth[depth] = [];\n        }\n        nodesByDepth[depth].push(node);\n    });\n\n    // Find the depth level with the most nodes\n    const maxNodesAtLevel = Math.max(...Object.values(nodesByDepth).map(nodes => nodes.length));\n\n    // Calculate required height: nodes * spacing (no margins needed with pan/zoom)\n    const requiredHeight = Math.max(\n        600, // Minimum height\n        maxNodesAtLevel * minNodeSpacing\n    );\n\n    return requiredHeight;\n}\n\n// Initialize with container height, will be recalculated for tree layout\nlet currentHeight = actualHeight;\n\n// Set up the SVG to exactly match the container (no manual sizing)\nsvg.attr(\"width\", actualWidth)\n    .attr(\"height\", actualHeight)\n    .style(\"background-color\", \"#fafafa\")\n    .style(\"overflow\", \"hidden\") // Remove scrollbars\n    .style(\"cursor\", \"grab\")\n    .style(\"display\", \"block\");\n\n// Add resize handler for responsive width\nwindow.addEventListener(\"resize\", function() {\n    const newWidth = getResponsiveWidth();\n    svg.attr(\"width\", newWidth);\n\n    // If there\"s tree content, we might want to recalculate layout\n    // For now, just update the SVG width - the pan/zoom will handle positioning\n});\n\n// Add zoom behavior\nconst zoom = d3.zoom()\n    .scaleExtent([0.1, 3]) // Zoom limits\n    .on(\"zoom\", (event) => {\n        container.attr(\"transform\", event.transform);\n        // Update cursor during pan\n        svg.style(\"cursor\", event.sourceEvent && event.sourceEvent.type === \"mousemove\" ? \"grabbing\" : \"grab\");\n    });\n\nsvg.call(zoom);\n\n// Create container for tree (this will be transformed by zoom/pan)\nconst container = svg.append(\"g\")\n    .attr(\"class\", \"tree-container\");\n\n// Add center button\nconst centerButton = svg.append(\"g\")\n    .attr(\"class\", \"center-button\")\n    .attr(\"transform\", \"translate(20, 20)\")\n    .style(\"cursor\", \"pointer\");\n\n// Button background\ncenterButton.append(\"rect\")\n    .attr(\"width\", 100)\n    .attr(\"height\", 30)\n    .attr(\"rx\", 5)\n    .style(\"fill\", \"#007acc\")\n    .style(\"stroke\", \"#005a9e\")\n    .style(\"stroke-width\", 1);\n\n// Button text\ncenterButton.append(\"text\")\n    .attr(\"x\", 50)\n    .attr(\"y\", 20)\n    .attr(\"text-anchor\", \"middle\")\n    .attr(\"dy\", \"0em\")\n    .style(\"fill\", \"white\")\n    .style(\"font-size\", \"12px\")\n    .style(\"font-weight\", \"bold\")\n    .style(\"pointer-events\", \"none\")\n    .text(\"Center root\");\n\n// Button click handler\ncenterButton.on(\"click\", function() {\n    centerOnRoot();\n});\n\n// Add \"Expand All\" button\nconst expandAllButton = svg.append(\"g\")\n    .attr(\"class\", \"expand-all-button\")\n    .attr(\"transform\", \"translate(20, 60)\") // Position below center button\n    .style(\"cursor\", \"pointer\");\n\n// Expand All button background\nexpandAllButton.append(\"rect\")\n    .attr(\"width\", 100)\n    .attr(\"height\", 30)\n    .attr(\"rx\", 5)\n    .style(\"fill\", \"#28a745\")\n    .style(\"stroke\", \"#1e7e34\")\n    .style(\"stroke-width\", 1);\n\n// Expand All button text\nexpandAllButton.append(\"text\")\n    .attr(\"x\", 50)\n    .attr(\"y\", 20)\n    .attr(\"text-anchor\", \"middle\")\n    .attr(\"dy\", \"0em\")\n    .style(\"fill\", \"white\")\n    .style(\"font-size\", \"12px\")\n    .style(\"font-weight\", \"bold\")\n    .style(\"pointer-events\", \"none\")\n    .text(\"Expand All\");\n\n// Expand All button click handler\nexpandAllButton.on(\"click\", function() {\n    expandAll();\n});\n\n// Add \"Fold All\" button\nconst foldAllButton = svg.append(\"g\")\n    .attr(\"class\", \"fold-all-button\")\n    .attr(\"transform\", \"translate(20, 100)\") // Position below expand button\n    .style(\"cursor\", \"pointer\");\n\n// Fold All button background\nfoldAllButton.append(\"rect\")\n    .attr(\"width\", 100)\n    .attr(\"height\", 30)\n    .attr(\"rx\", 5)\n    .style(\"fill\", \"#dc3545\")\n    .style(\"stroke\", \"#c82333\")\n    .style(\"stroke-width\", 1);\n\n// Fold All button text\nfoldAllButton.append(\"text\")\n    .attr(\"x\", 50)\n    .attr(\"y\", 20)\n    .attr(\"text-anchor\", \"middle\")\n    .attr(\"dy\", \"0em\")\n    .style(\"fill\", \"white\")\n    .style(\"font-size\", \"12px\")\n    .style(\"font-weight\", \"bold\")\n    .style(\"pointer-events\", \"none\")\n    .text(\"Fold All\");\n\n// Fold All button click handler\nfoldAllButton.on(\"click\", function() {\n    foldAll();\n});\n\n// Function to center the view on the root node\nfunction centerOnRoot() {\n    if (!hierarchyRoot) return;\n\n    // Find the actual root node position after tree layout\n    const rootNode = hierarchyRoot;\n    const rootX = rootNode.x || 0;\n    const rootY = rootNode.y || 0;\n\n    // Calculate transform to center the root in the actual viewport\n    const centerX = actualWidth / 2;\n    const centerY = actualHeight / 2; // Center in actual viewport\n\n    const transform = d3.zoomIdentity\n        .translate(centerX - rootY, centerY - rootX) // Note: x and y are swapped in horizontal tree\n        .scale(1); // Reset zoom to 1x\n\n    // Animate to center\n    svg.transition()\n        .duration(750)\n        .call(zoom.transform, transform);\n} // Copy data and create persistent hierarchy\nlet currentData = JSON.parse(JSON.stringify(data.tree));\nlet hierarchyRoot = null; // Keep the hierarchy root persistent\nlet isFirstRender = true; // Track if this is the first render\n\n// Collapse function for raw data (not used anymore but keeping for reference)\nfunction collapseToFirstLevel(node, depth = 0) {\n    if (depth >= 1 && node.children) {\n        node._children = node.children;\n        node.children = null;\n    }\n    if (node.children) {\n        node.children.forEach(child => collapseToFirstLevel(child, depth + 1));\n    }\n}\n\n// Collapse function for D3 hierarchy nodes (the one we actually use)\nfunction collapseHierarchyToFirstLevel(node, depth = 0) {\n\n    if (depth >= 1 && node.children) {\n        node._children = node.children;\n        node.children = null;\n    }\n\n    // Continue recursively for visible children\n    if (node.children) {\n        node.children.forEach(child => collapseHierarchyToFirstLevel(child, depth + 1));\n    }\n\n    // Also process hidden children to ensure deep collapse\n    if (node._children) {\n        node._children.forEach(child => collapseHierarchyToFirstLevel(child, depth + 1));\n    }\n}\n\n// Sort children by accumulated size (largest first)\nfunction sortChildrenBySize(node) {\n    // Sort visible children\n    if (node.children) {\n        node.children.sort((a, b) => calculateTotalSize(b) - calculateTotalSize(a));\n        // Recursively sort their children too\n        node.children.forEach(child => sortChildrenBySize(child));\n    }\n\n    // Sort hidden children (so they\"re in the right order when expanded)\n    if (node._children) {\n        node._children.sort((a, b) => calculateTotalSize(b) - calculateTotalSize(a));\n        // Recursively sort their children too\n        node._children.forEach(child => sortChildrenBySize(child));\n    }\n}\n\n// Find a node in the hierarchy by name\nfunction findNodeByName(root, name) {\n    if (root.data.name === name) {\n        return root;\n    }\n    if (root.children) {\n        for (let child of root.children) {\n            const found = findNodeByName(child, name);\n            if (found) return found;\n        }\n    }\n    if (root._children) {\n        for (let child of root._children) {\n            const found = findNodeByName(child, name);\n            if (found) return found;\n        }\n    }\n    return null;\n}\n\n// Check if a node has expandable children in persistent hierarchy\nfunction hasExpandableChildren(nodeName) {\n    if (!nodeName || !hierarchyRoot) {\n        console.warn(\"hasExpandableChildren: Invalid parameters\", {\n            nodeName,\n            hierarchyRoot: !!hierarchyRoot\n        });\n        return false;\n    }\n    const persistentNode = findNodeByName(hierarchyRoot, nodeName);\n    return persistentNode && (persistentNode.children || persistentNode._children);\n}\n\n// Check if a node is collapsed in persistent hierarchy\nfunction isCollapsed(nodeName) {\n    if (!nodeName || !hierarchyRoot) {\n        console.warn(\"isCollapsed: Invalid parameters\", {\n            nodeName,\n            hierarchyRoot: !!hierarchyRoot\n        });\n        return false;\n    }\n    const persistentNode = findNodeByName(hierarchyRoot, nodeName);\n    return persistentNode && persistentNode._children && !persistentNode.children;\n}\n\n// Calculate the total size of a node including all its descendants\nfunction calculateTotalSize(node) {\n    let totalSize = node.data.size || 0;\n\n    // Add sizes from visible children\n    if (node.children) {\n        for (let child of node.children) {\n            totalSize += calculateTotalSize(child);\n        }\n    }\n\n    // Add sizes from hidden children (collapsed nodes)\n    if (node._children) {\n        for (let child of node._children) {\n            totalSize += calculateTotalSize(child);\n        }\n    }\n\n    return totalSize;\n}\n\n// Get the effective size for display (aggregated size for collapsed nodes)\nfunction getEffectiveSize(displayNode, nodeName) {\n    const persistentNode = findNodeByName(hierarchyRoot, nodeName);\n\n    if (persistentNode && isCollapsed(nodeName)) {\n        // For collapsed nodes, return the total aggregated size\n        return calculateTotalSize(persistentNode);\n    } else {\n        // For expanded nodes or leaf nodes, return their own size\n        return displayNode.data.size || 0;\n    }\n}\n\n// Toggle function\nfunction toggle(d) {\n    // Safety check for data structure\n    if (!d.data) {\n        console.error(\"Node data is undefined, skipping toggle\");\n        return;\n    }\n    // Find the corresponding node in our persistent hierarchy\n    const persistentNode = findNodeByName(hierarchyRoot, d.data.name);\n    if (!persistentNode) {\n        console.error(\"Could not find node in persistent hierarchy:\", d.data.name);\n        return;\n    }\n\n    if (persistentNode.children) {\n        persistentNode._children = persistentNode.children;\n        persistentNode.children = null;\n    } else if (persistentNode._children) {\n        persistentNode.children = persistentNode._children;\n        persistentNode._children = null;\n    }\n\n    // Re-sort the entire hierarchy to maintain size-based ordering\n    sortChildrenBySize(hierarchyRoot);\n\n    update();\n}\n\n// Expand All function\nfunction expandAll() {\n    if (!hierarchyRoot) return;\n\n    // Recursively expand all nodes\n    function expandAllNodes(node) {\n        if (node._children) {\n            node.children = node._children;\n            node._children = null;\n        }\n        if (node.children) {\n            node.children.forEach(child => expandAllNodes(child));\n        }\n    }\n\n    expandAllNodes(hierarchyRoot);\n    sortChildrenBySize(hierarchyRoot);\n    update();\n\n    // Center on root and zoom out 30%\n    setTimeout(() => {\n        if (!hierarchyRoot) return;\n\n        const rootNode = hierarchyRoot;\n        const rootX = rootNode.x || 0;\n        const rootY = rootNode.y || 0;\n\n        const centerX = actualWidth / 2;\n        const centerY = actualHeight / 2;\n\n        const transform = d3.zoomIdentity\n            .translate(centerX - rootY, centerY - rootX)\n            .scale(0.7); // Zoom out 30% (100% - 30% = 70%)\n\n        svg.transition()\n            .duration(750)\n            .call(zoom.transform, transform);\n    }, 100); // Small delay to let the tree update first\n}\n\n// Fold All function\nfunction foldAll() {\n    if (!hierarchyRoot) return;\n\n    // Collapse everything to root only (no children visible)\n    function collapseToRoot(node) {\n        if (node.children) {\n            node._children = node.children;\n            node.children = null;\n        }\n        if (node._children) {\n            node._children.forEach(child => collapseToRoot(child));\n        }\n    }\n\n    collapseToRoot(hierarchyRoot);\n    sortChildrenBySize(hierarchyRoot);\n    update();\n\n    // Center on root with normal zoom (same as center button)\n    setTimeout(() => {\n        centerOnRoot();\n    }, 100); // Small delay to let the tree update first\n}\n\n// Update function\nfunction update() {\n    // Clear previous content (but keep the center button)\n    container.selectAll(\"*\").remove();\n\n    // Create or use existing hierarchy\n    if (isFirstRender) {\n        hierarchyRoot = d3.hierarchy(currentData);\n        collapseHierarchyToFirstLevel(hierarchyRoot, 0);\n        // Sort all nodes by accumulated size after initial setup\n        sortChildrenBySize(hierarchyRoot);\n        isFirstRender = false;\n    }\n\n    const root = hierarchyRoot;\n\n    // Calculate required height dynamically for tree layout\n    currentHeight = calculateRequiredHeight(root);\n\n    // Set up tree layout with full available space (no margins)\n    const treeLayout = d3.tree().size([currentHeight, actualWidth]);\n    treeLayout(root);\n\n    // Position the tree centered in the actual viewport\n    const startX = 0; // No left margin needed\n    const startY = actualHeight / 2; // Center in actual viewport\n\n    // Adjust all node positions\n    root.descendants().forEach(d => {\n        d.x = d.x - currentHeight / 2 + startY; // Center in actual viewport\n        d.y = d.y + startX; // Start from left edge\n    });\n\n    // Scale for node sizes - now considering aggregated sizes for collapsed nodes\n    const allEffectiveSizes = root.descendants().map(d => getEffectiveSize(d, d.data.name));\n    const sizeScale = d3.scaleLinear()\n        .domain([0, d3.max(allEffectiveSizes) || 1])\n        .range([4, 15]);\n\n    // Convert weights data frame to lookup object\n    const weightsLookup = {};\n    if (data.weights && Array.isArray(data.weights.key)) {\n        // R data frame comes as arrays of columns\n        for (let i = 0; i < data.weights.key.length; i++) {\n            weightsLookup[data.weights.key[i]] = data.weights.weight[i];\n        }\n    }\n\n    // Function to get edge weight from lookup\n    function getEdgeWeight(link) {\n        if (Object.keys(weightsLookup).length === 0) {\n            return null;\n        }\n        // In your graph: edges go child->parent\n        // In D3 tree: link.target = child, link.source = parent\n        // So: target->source = child->parent\n        const key = link.target.data.name + \"->\" + link.source.data.name;\n        return weightsLookup[key] || null;\n    }\n    \n    // Create scales for edge styling based on weights\n    const allWeights = root.links()\n        .map(link => getEdgeWeight(link))\n        .filter(w => w !== null);\n    \n    let strokeWidthScale, strokeColorScale;\n    if (allWeights.length > 0) {\n        const minWeight = d3.min(allWeights);\n        const maxWeight = d3.max(allWeights);\n        \n        // Stroke width: thin (0.5) for small weights, thick (4) for large weights\n        strokeWidthScale = d3.scaleLinear()\n            .domain([minWeight, maxWeight])\n            .range([0.5, 4]);\n        \n        // Stroke color: light gray for small weights, black for large weights\n        strokeColorScale = d3.scaleLinear()\n            .domain([minWeight, maxWeight])\n            .range([\"#e0e0e0\", \"#000000\"]);\n    }\n\n    // Create links\n    const links = container.selectAll(\".link\")\n        .data(root.links())\n        .enter()\n        .append(\"path\")\n        .attr(\"class\", \"link\")\n        .attr(\"d\", d3.linkHorizontal()\n            .x(d => d.y)\n            .y(d => d.x))\n        .style(\"fill\", \"none\")\n        .style(\"stroke\", d => {\n            const weight = getEdgeWeight(d);\n            return (weight !== null && strokeColorScale) ? strokeColorScale(weight) : \"#ccc\";\n        })\n        .style(\"stroke-width\", d => {\n            const weight = getEdgeWeight(d);\n            return (weight !== null && strokeWidthScale) ? strokeWidthScale(weight) : 2;\n        });\n\n    // Add tooltips to links\n    links.append(\"title\")\n        .text(d => {\n            const weight = getEdgeWeight(d);\n            if (weight !== null) {\n                return `${d.target.data.name} → ${d.source.data.name}\\nWeight: ${weight.toFixed(4)}`;\n            }\n            return `${d.target.data.name} → ${d.source.data.name}`;\n        });\n\n    // Create node groups\n    const nodes = container.selectAll(\".node\")\n        .data(root.descendants())\n        .enter()\n        .append(\"g\")\n        .attr(\"class\", \"node\")\n        .attr(\"transform\", d => `translate(${d.y}, ${d.x})`)\n        .style(\"cursor\", d => (d.data && hasExpandableChildren(d.data.name)) ? \"pointer\" : \"default\");\n\n    // Add circles\n    nodes.append(\"circle\")\n        .attr(\"r\", d => sizeScale(getEffectiveSize(d, d.data.name)))\n        .style(\"fill\", d => d.data.fill || \"#69b3a2\")\n        .style(\"stroke\", d => (d.data && hasExpandableChildren(d.data.name)) ? \"#000\" : \"none\")\n        .style(\"stroke-width\", d => (d.data && hasExpandableChildren(d.data.name)) ? 2 : 1)\n        .on(\"click\", function(event, d) {\n            // Prevent zoom behavior when clicking on nodes\n            event.stopPropagation();\n\n            // Check persistent hierarchy instead of display node\n            const persistentNode = findNodeByName(hierarchyRoot, d.data.name);\n            if (persistentNode) {\n                if (persistentNode._children || persistentNode.children) {\n                    toggle(d);\n                }\n            }\n        })\n        .on(\"mouseover\", function(event, d) {\n            if (d.data && hasExpandableChildren(d.data.name)) {\n                d3.select(this).style(\"stroke-width\", 4);\n            }\n        })\n        .on(\"mouseout\", function(event, d) {\n            d3.select(this).style(\"stroke-width\", (d.data && hasExpandableChildren(d.data.name)) ? 2 : 1);\n        });\n\n    // Add +/- indicators\n    nodes.filter(d => d.data && hasExpandableChildren(d.data.name))\n        .append(\"text\")\n        .attr(\"text-anchor\", \"middle\")\n        .attr(\"dy\", 4)\n        .style(\"font-size\", \"10px\")\n        .style(\"font-weight\", \"bold\")\n        .style(\"fill\", \"white\")\n        .style(\"pointer-events\", \"none\")\n        .text(d => isCollapsed(d.data.name) ? \"+\" : \"−\");\n\n    // Add labels\n    nodes.append(\"text\")\n        .attr(\"dy\", 3)\n        .attr(\"x\", d => hasExpandableChildren(d.data.name) ? -18 : 18)\n        .style(\"text-anchor\", d => hasExpandableChildren(d.data.name) ? \"end\" : \"start\")\n        .style(\"font-size\", \"12pt\")\n        .style(\"font-weight\", d => hasExpandableChildren(d.data.name) ? \"bold\" : \"normal\")\n        .style(\"text-decoration\", d => hasExpandableChildren(d.data.name) ? \"underline\" : \"none\")\n        .style(\"fill\", d => {\n            if (hasExpandableChildren(d.data.name)) return \"#0066cc\"; // Expandable nodes = blue\n            return \"#333\"; // Leaf nodes = dark gray\n        })\n        .style(\"cursor\", d => hasExpandableChildren(d.data.name) ? \"pointer\" : \"default\")\n        .text(d => d.data.name)\n        .on(\"click\", function(event, d) {\n            // Prevent zoom behavior when clicking on text\n            event.stopPropagation();\n\n            // Check persistent hierarchy instead of display node\n            const persistentNode = findNodeByName(hierarchyRoot, d.data.name);\n            if (persistentNode) {\n                if (persistentNode._children || persistentNode.children) {\n                    toggle(d);\n                }\n            }\n        })\n        .on(\"mouseover\", function(event, d) {\n            if (hasExpandableChildren(d.data.name)) {\n                d3.select(this).style(\"fill\", \"#0044aa\");\n            }\n        })\n        .on(\"mouseout\", function(event, d) {\n            d3.select(this).style(\"fill\", hasExpandableChildren(d.data.name) ? \"#0066cc\" : \"#333\");\n        });\n\n    // Add tooltips\n    nodes.append(\"title\")\n        .text(d => {\n            const effectiveSize = getEffectiveSize(d, d.data.name);\n            const originalSize = d.data.size || 0;\n\n            if (hasExpandableChildren(d.data.name)) {\n                const action = isCollapsed(d.data.name) ? \"expand\" : \"collapse\";\n                if (isCollapsed(d.data.name) && effectiveSize > originalSize) {\n                    return `${d.data.name} (Click to ${action}) - Aggregated size: ${effectiveSize} (own: ${originalSize})`;\n                } else {\n                    return `${d.data.name} (Click to ${action}) - Size: ${effectiveSize}`;\n                }\n            }\n            return `${d.data.name} - Size: ${effectiveSize}`;\n        });\n}\n\n// Initial render\nupdate();\n\n// Center on root after initial render\nsetTimeout(() => {\n    centerOnRoot();\n}, 100); // Small delay to ensure rendering is complete\n};","style":null,"version":6,"theme":{"default":{"background":"#FFFFFF","foreground":"#000000"},"runtime":null},"useShadow":true},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>